<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>哥村小饭桌 - 管理员后台</title>
  <script>
    // 设置管理员模式标记
    window.__ADMIN_MODE__ = true;
    
    // 动态加载资源文件
    function loadMainApp() {
      // 基础路径
      const basePath = '/gcxfz';
      
      // 尝试加载主应用的index.html内容
      fetch(`${basePath}/index.html`)
        .then(response => response.text())
        .then(html => {
          // 解析HTML获取实际的资源文件路径
          const parser = new DOMParser();
          const doc = parser.parseFromString(html, 'text/html');
          
          // 获取CSS文件
          const cssLink = doc.querySelector('link[rel="stylesheet"]');
          if (cssLink) {
            const css = document.createElement('link');
            css.rel = 'stylesheet';
            css.href = cssLink.href.startsWith('http') ? cssLink.href : `${basePath}${cssLink.getAttribute('href')}`;
            document.head.appendChild(css);
          }
          
          // 获取JS文件
          const jsScript = doc.querySelector('script[type="module"]');
          if (jsScript) {
            const script = document.createElement('script');
            script.type = 'module';
            script.crossOrigin = 'anonymous';
            script.src = jsScript.src.startsWith('http') ? jsScript.src : `${basePath}${jsScript.getAttribute('src')}`;
            
            script.onload = () => {
              // 强制管理员模式
              if (!window.location.search.includes('admin')) {
                const newUrl = new URL(window.location);
                newUrl.searchParams.set('admin', 'login');
                window.history.replaceState(null, '', newUrl.toString());
              }
              
              // 触发页面重新渲染
              if (window.location.reload) {
                setTimeout(() => {
                  if (!document.querySelector('.admin-login') && !document.querySelector('.admin-dashboard')) {
                    window.location.reload();
                  }
                }, 1000);
              }
            };
            
            document.head.appendChild(script);
          }
        })
        .catch(error => {
          console.error('加载主应用失败:', error);
          // 回退方案：重定向到主页面
          window.location.href = `${basePath}/?admin=login`;
        });
    }
    
    // 页面加载完成后执行
    document.addEventListener('DOMContentLoaded', loadMainApp);
  </script>
</head>
<body>
  <div id="root">
    <div style="display: flex; justify-content: center; align-items: center; height: 100vh; font-family: Arial, sans-serif;">
      <div style="text-align: center;">
        <div style="margin-bottom: 20px;">
          <div style="width: 50px; height: 50px; border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto;"></div>
        </div>
        <h2 style="color: #333; margin-bottom: 10px;">哥村小饭桌</h2>
        <p style="color: #666;">正在加载管理员后台...</p>
      </div>
    </div>
  </div>
  
  <style>
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    body {
      margin: 0;
      padding: 0;
      background-color: #f5f5f5;
    }
  </style>
</body>
</html> 