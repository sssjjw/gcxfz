import{r as m,a as ds,R as ms,b as qe}from"./vendor-Bm7FCeSL-1751836592382.js";import{i as xs,g as us,a as hs,b as ce,q as ft,c as W,o as yt,d as $t,s as ve,u as Rt,e as K,f as lt,h as Lt,j as ps,k as gs,w as be,T as bt}from"./firebase-BlW410b--1751836592382.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();var Pt={exports:{}},ze={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fs=m,ys=Symbol.for("react.element"),bs=Symbol.for("react.fragment"),vs=Object.prototype.hasOwnProperty,js=fs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ns={key:!0,ref:!0,__self:!0,__source:!0};function Ft(t,a,s){var r,n={},i=null,o=null;s!==void 0&&(i=""+s),a.key!==void 0&&(i=""+a.key),a.ref!==void 0&&(o=a.ref);for(r in a)vs.call(a,r)&&!Ns.hasOwnProperty(r)&&(n[r]=a[r]);if(t&&t.defaultProps)for(r in a=t.defaultProps,a)n[r]===void 0&&(n[r]=a[r]);return{$$typeof:ys,type:t,key:i,ref:o,props:n,_owner:js.current}}ze.Fragment=bs;ze.jsx=Ft;ze.jsxs=Ft;Pt.exports=ze;var e=Pt.exports,Ye={},vt=ds;Ye.createRoot=vt.createRoot,Ye.hydrateRoot=vt.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ke(){return ke=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},ke.apply(this,arguments)}var Z;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Z||(Z={}));const jt="popstate";function ws(t){t===void 0&&(t={});function a(r,n){let{pathname:i,search:o,hash:h}=r.location;return Ze("",{pathname:i,search:o,hash:h},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function s(r,n){return typeof n=="string"?n:Le(n)}return ks(a,s,null,t)}function q(t,a){if(t===!1||t===null||typeof t>"u")throw new Error(a)}function Tt(t,a){if(!t){typeof console<"u"&&console.warn(a);try{throw new Error(a)}catch{}}}function Ss(){return Math.random().toString(36).substr(2,8)}function Nt(t,a){return{usr:t.state,key:t.key,idx:a}}function Ze(t,a,s,r){return s===void 0&&(s=null),ke({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof a=="string"?he(a):a,{state:s,key:a&&a.key||r||Ss()})}function Le(t){let{pathname:a="/",search:s="",hash:r=""}=t;return s&&s!=="?"&&(a+=s.charAt(0)==="?"?s:"?"+s),r&&r!=="#"&&(a+=r.charAt(0)==="#"?r:"#"+r),a}function he(t){let a={};if(t){let s=t.indexOf("#");s>=0&&(a.hash=t.substr(s),t=t.substr(0,s));let r=t.indexOf("?");r>=0&&(a.search=t.substr(r),t=t.substr(0,r)),t&&(a.pathname=t)}return a}function ks(t,a,s,r){r===void 0&&(r={});let{window:n=document.defaultView,v5Compat:i=!1}=r,o=n.history,h=Z.Pop,x=null,y=N();y==null&&(y=0,o.replaceState(ke({},o.state,{idx:y}),""));function N(){return(o.state||{idx:null}).idx}function d(){h=Z.Pop;let p=N(),g=p==null?null:p-y;y=p,x&&x({action:h,location:b.location,delta:g})}function j(p,g){h=Z.Push;let f=Ze(b.location,p,g);y=N()+1;let u=Nt(f,y),l=b.createHref(f);try{o.pushState(u,"",l)}catch(c){if(c instanceof DOMException&&c.name==="DataCloneError")throw c;n.location.assign(l)}i&&x&&x({action:h,location:b.location,delta:1})}function S(p,g){h=Z.Replace;let f=Ze(b.location,p,g);y=N();let u=Nt(f,y),l=b.createHref(f);o.replaceState(u,"",l),i&&x&&x({action:h,location:b.location,delta:0})}function w(p){let g=n.location.origin!=="null"?n.location.origin:n.location.href,f=typeof p=="string"?p:Le(p);return f=f.replace(/ $/,"%20"),q(g,"No window.location.(origin|href) available to create URL for href: "+f),new URL(f,g)}let b={get action(){return h},get location(){return t(n,o)},listen(p){if(x)throw new Error("A history only accepts one active listener");return n.addEventListener(jt,d),x=p,()=>{n.removeEventListener(jt,d),x=null}},createHref(p){return a(n,p)},createURL:w,encodeLocation(p){let g=w(p);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:j,replace:S,go(p){return o.go(p)}};return b}var wt;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(wt||(wt={}));function Cs(t,a,s){return s===void 0&&(s="/"),Os(t,a,s,!1)}function Os(t,a,s,r){let n=typeof a=="string"?he(a):a,i=xe(n.pathname||"/",s);if(i==null)return null;let o=Ut(t);Ds(o);let h=null;for(let x=0;h==null&&x<o.length;++x){let y=Us(i);h=Fs(o[x],y,r)}return h}function Ut(t,a,s,r){a===void 0&&(a=[]),s===void 0&&(s=[]),r===void 0&&(r="");let n=(i,o,h)=>{let x={relativePath:h===void 0?i.path||"":h,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};x.relativePath.startsWith("/")&&(q(x.relativePath.startsWith(r),'Absolute route path "'+x.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),x.relativePath=x.relativePath.slice(r.length));let y=X([r,x.relativePath]),N=s.concat(x);i.children&&i.children.length>0&&(q(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+y+'".')),Ut(i.children,a,N,y)),!(i.path==null&&!i.index)&&a.push({path:y,score:Ls(y,i.index),routesMeta:N})};return t.forEach((i,o)=>{var h;if(i.path===""||!((h=i.path)!=null&&h.includes("?")))n(i,o);else for(let x of qt(i.path))n(i,o,x)}),a}function qt(t){let a=t.split("/");if(a.length===0)return[];let[s,...r]=a,n=s.endsWith("?"),i=s.replace(/\?$/,"");if(r.length===0)return n?[i,""]:[i];let o=qt(r.join("/")),h=[];return h.push(...o.map(x=>x===""?i:[i,x].join("/"))),n&&h.push(...o),h.map(x=>t.startsWith("/")&&x===""?"/":x)}function Ds(t){t.sort((a,s)=>a.score!==s.score?s.score-a.score:Ps(a.routesMeta.map(r=>r.childrenIndex),s.routesMeta.map(r=>r.childrenIndex)))}const Es=/^:[\w-]+$/,Is=3,Ms=2,As=1,$s=10,Rs=-2,St=t=>t==="*";function Ls(t,a){let s=t.split("/"),r=s.length;return s.some(St)&&(r+=Rs),a&&(r+=Ms),s.filter(n=>!St(n)).reduce((n,i)=>n+(Es.test(i)?Is:i===""?As:$s),r)}function Ps(t,a){return t.length===a.length&&t.slice(0,-1).every((r,n)=>r===a[n])?t[t.length-1]-a[a.length-1]:0}function Fs(t,a,s){let{routesMeta:r}=t,n={},i="/",o=[];for(let h=0;h<r.length;++h){let x=r[h],y=h===r.length-1,N=i==="/"?a:a.slice(i.length)||"/",d=Pe({path:x.relativePath,caseSensitive:x.caseSensitive,end:y},N),j=x.route;if(!d&&y&&s&&!r[r.length-1].route.index&&(d=Pe({path:x.relativePath,caseSensitive:x.caseSensitive,end:!1},N)),!d)return null;Object.assign(n,d.params),o.push({params:n,pathname:X([i,d.pathname]),pathnameBase:_s(X([i,d.pathnameBase])),route:j}),d.pathnameBase!=="/"&&(i=X([i,d.pathnameBase]))}return o}function Pe(t,a){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[s,r]=Ts(t.path,t.caseSensitive,t.end),n=a.match(s);if(!n)return null;let i=n[0],o=i.replace(/(.)\/+$/,"$1"),h=n.slice(1);return{params:r.reduce((y,N,d)=>{let{paramName:j,isOptional:S}=N;if(j==="*"){let b=h[d]||"";o=i.slice(0,i.length-b.length).replace(/(.)\/+$/,"$1")}const w=h[d];return S&&!w?y[j]=void 0:y[j]=(w||"").replace(/%2F/g,"/"),y},{}),pathname:i,pathnameBase:o,pattern:t}}function Ts(t,a,s){a===void 0&&(a=!1),s===void 0&&(s=!0),Tt(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],n="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,h,x)=>(r.push({paramName:h,isOptional:x!=null}),x?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),n+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?n+="\\/*$":t!==""&&t!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,a?void 0:"i"),r]}function Us(t){try{return t.split("/").map(a=>decodeURIComponent(a).replace(/\//g,"%2F")).join("/")}catch(a){return Tt(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+a+").")),t}}function xe(t,a){if(a==="/")return t;if(!t.toLowerCase().startsWith(a.toLowerCase()))return null;let s=a.endsWith("/")?a.length-1:a.length,r=t.charAt(s);return r&&r!=="/"?null:t.slice(s)||"/"}function qs(t,a){a===void 0&&(a="/");let{pathname:s,search:r="",hash:n=""}=typeof t=="string"?he(t):t;return{pathname:s?s.startsWith("/")?s:zs(s,a):a,search:Js(r),hash:Vs(n)}}function zs(t,a){let s=a.replace(/\/+$/,"").split("/");return t.split("/").forEach(n=>{n===".."?s.length>1&&s.pop():n!=="."&&s.push(n)}),s.length>1?s.join("/"):"/"}function Ke(t,a,s,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+a+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Bs(t){return t.filter((a,s)=>s===0||a.route.path&&a.route.path.length>0)}function ot(t,a){let s=Bs(t);return a?s.map((r,n)=>n===s.length-1?r.pathname:r.pathnameBase):s.map(r=>r.pathnameBase)}function it(t,a,s,r){r===void 0&&(r=!1);let n;typeof t=="string"?n=he(t):(n=ke({},t),q(!n.pathname||!n.pathname.includes("?"),Ke("?","pathname","search",n)),q(!n.pathname||!n.pathname.includes("#"),Ke("#","pathname","hash",n)),q(!n.search||!n.search.includes("#"),Ke("#","search","hash",n)));let i=t===""||n.pathname==="",o=i?"/":n.pathname,h;if(o==null)h=s;else{let d=a.length-1;if(!r&&o.startsWith("..")){let j=o.split("/");for(;j[0]==="..";)j.shift(),d-=1;n.pathname=j.join("/")}h=d>=0?a[d]:"/"}let x=qs(n,h),y=o&&o!=="/"&&o.endsWith("/"),N=(i||o===".")&&s.endsWith("/");return!x.pathname.endsWith("/")&&(y||N)&&(x.pathname+="/"),x}const X=t=>t.join("/").replace(/\/\/+/g,"/"),_s=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Js=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Vs=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Ws(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const zt=["post","put","patch","delete"];new Set(zt);const Hs=["get",...zt];new Set(Hs);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ce(){return Ce=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},Ce.apply(this,arguments)}const Be=m.createContext(null),Bt=m.createContext(null),Y=m.createContext(null),_e=m.createContext(null),te=m.createContext({outlet:null,matches:[],isDataRoute:!1}),_t=m.createContext(null);function Ks(t,a){let{relative:s}=a===void 0?{}:a;pe()||q(!1);let{basename:r,navigator:n}=m.useContext(Y),{hash:i,pathname:o,search:h}=Je(t,{relative:s}),x=o;return r!=="/"&&(x=o==="/"?r:X([r,o])),n.createHref({pathname:x,search:h,hash:i})}function pe(){return m.useContext(_e)!=null}function ge(){return pe()||q(!1),m.useContext(_e).location}function Jt(t){m.useContext(Y).static||m.useLayoutEffect(t)}function Oe(){let{isDataRoute:t}=m.useContext(te);return t?oa():Qs()}function Qs(){pe()||q(!1);let t=m.useContext(Be),{basename:a,future:s,navigator:r}=m.useContext(Y),{matches:n}=m.useContext(te),{pathname:i}=ge(),o=JSON.stringify(ot(n,s.v7_relativeSplatPath)),h=m.useRef(!1);return Jt(()=>{h.current=!0}),m.useCallback(function(y,N){if(N===void 0&&(N={}),!h.current)return;if(typeof y=="number"){r.go(y);return}let d=it(y,JSON.parse(o),i,N.relative==="path");t==null&&a!=="/"&&(d.pathname=d.pathname==="/"?a:X([a,d.pathname])),(N.replace?r.replace:r.push)(d,N.state,N)},[a,r,o,i,t])}function Je(t,a){let{relative:s}=a===void 0?{}:a,{future:r}=m.useContext(Y),{matches:n}=m.useContext(te),{pathname:i}=ge(),o=JSON.stringify(ot(n,r.v7_relativeSplatPath));return m.useMemo(()=>it(t,JSON.parse(o),i,s==="path"),[t,o,i,s])}function Gs(t,a){return Ys(t,a)}function Ys(t,a,s,r){pe()||q(!1);let{navigator:n}=m.useContext(Y),{matches:i}=m.useContext(te),o=i[i.length-1],h=o?o.params:{};o&&o.pathname;let x=o?o.pathnameBase:"/";o&&o.route;let y=ge(),N;if(a){var d;let p=typeof a=="string"?he(a):a;x==="/"||(d=p.pathname)!=null&&d.startsWith(x)||q(!1),N=p}else N=y;let j=N.pathname||"/",S=j;if(x!=="/"){let p=x.replace(/^\//,"").split("/");S="/"+j.replace(/^\//,"").split("/").slice(p.length).join("/")}let w=Cs(t,{pathname:S}),b=sa(w&&w.map(p=>Object.assign({},p,{params:Object.assign({},h,p.params),pathname:X([x,n.encodeLocation?n.encodeLocation(p.pathname).pathname:p.pathname]),pathnameBase:p.pathnameBase==="/"?x:X([x,n.encodeLocation?n.encodeLocation(p.pathnameBase).pathname:p.pathnameBase])})),i,s,r);return a&&b?m.createElement(_e.Provider,{value:{location:Ce({pathname:"/",search:"",hash:"",state:null,key:"default"},N),navigationType:Z.Pop}},b):b}function Zs(){let t=la(),a=Ws(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),s=t instanceof Error?t.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return m.createElement(m.Fragment,null,m.createElement("h2",null,"Unexpected Application Error!"),m.createElement("h3",{style:{fontStyle:"italic"}},a),s?m.createElement("pre",{style:n},s):null,null)}const Xs=m.createElement(Zs,null);class ea extends m.Component{constructor(a){super(a),this.state={location:a.location,revalidation:a.revalidation,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,s){return s.location!==a.location||s.revalidation!=="idle"&&a.revalidation==="idle"?{error:a.error,location:a.location,revalidation:a.revalidation}:{error:a.error!==void 0?a.error:s.error,location:s.location,revalidation:a.revalidation||s.revalidation}}componentDidCatch(a,s){console.error("React Router caught the following error during render",a,s)}render(){return this.state.error!==void 0?m.createElement(te.Provider,{value:this.props.routeContext},m.createElement(_t.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ta(t){let{routeContext:a,match:s,children:r}=t,n=m.useContext(Be);return n&&n.static&&n.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=s.route.id),m.createElement(te.Provider,{value:a},r)}function sa(t,a,s,r){var n;if(a===void 0&&(a=[]),s===void 0&&(s=null),r===void 0&&(r=null),t==null){var i;if(!s)return null;if(s.errors)t=s.matches;else if((i=r)!=null&&i.v7_partialHydration&&a.length===0&&!s.initialized&&s.matches.length>0)t=s.matches;else return null}let o=t,h=(n=s)==null?void 0:n.errors;if(h!=null){let N=o.findIndex(d=>d.route.id&&(h==null?void 0:h[d.route.id])!==void 0);N>=0||q(!1),o=o.slice(0,Math.min(o.length,N+1))}let x=!1,y=-1;if(s&&r&&r.v7_partialHydration)for(let N=0;N<o.length;N++){let d=o[N];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(y=N),d.route.id){let{loaderData:j,errors:S}=s,w=d.route.loader&&j[d.route.id]===void 0&&(!S||S[d.route.id]===void 0);if(d.route.lazy||w){x=!0,y>=0?o=o.slice(0,y+1):o=[o[0]];break}}}return o.reduceRight((N,d,j)=>{let S,w=!1,b=null,p=null;s&&(S=h&&d.route.id?h[d.route.id]:void 0,b=d.route.errorElement||Xs,x&&(y<0&&j===0?(w=!0,p=null):y===j&&(w=!0,p=d.route.hydrateFallbackElement||null)));let g=a.concat(o.slice(0,j+1)),f=()=>{let u;return S?u=b:w?u=p:d.route.Component?u=m.createElement(d.route.Component,null):d.route.element?u=d.route.element:u=N,m.createElement(ta,{match:d,routeContext:{outlet:N,matches:g,isDataRoute:s!=null},children:u})};return s&&(d.route.ErrorBoundary||d.route.errorElement||j===0)?m.createElement(ea,{location:s.location,revalidation:s.revalidation,component:b,error:S,children:f(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):f()},null)}var Vt=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Vt||{}),Fe=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Fe||{});function aa(t){let a=m.useContext(Be);return a||q(!1),a}function ra(t){let a=m.useContext(Bt);return a||q(!1),a}function na(t){let a=m.useContext(te);return a||q(!1),a}function Wt(t){let a=na(),s=a.matches[a.matches.length-1];return s.route.id||q(!1),s.route.id}function la(){var t;let a=m.useContext(_t),s=ra(Fe.UseRouteError),r=Wt(Fe.UseRouteError);return a!==void 0?a:(t=s.errors)==null?void 0:t[r]}function oa(){let{router:t}=aa(Vt.UseNavigateStable),a=Wt(Fe.UseNavigateStable),s=m.useRef(!1);return Jt(()=>{s.current=!0}),m.useCallback(function(n,i){i===void 0&&(i={}),s.current&&(typeof n=="number"?t.navigate(n):t.navigate(n,Ce({fromRouteId:a},i)))},[t,a])}function ia(t,a){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function we(t){let{to:a,replace:s,state:r,relative:n}=t;pe()||q(!1);let{future:i,static:o}=m.useContext(Y),{matches:h}=m.useContext(te),{pathname:x}=ge(),y=Oe(),N=it(a,ot(h,i.v7_relativeSplatPath),x,n==="path"),d=JSON.stringify(N);return m.useEffect(()=>y(JSON.parse(d),{replace:s,state:r,relative:n}),[y,d,n,s,r]),null}function _(t){q(!1)}function ca(t){let{basename:a="/",children:s=null,location:r,navigationType:n=Z.Pop,navigator:i,static:o=!1,future:h}=t;pe()&&q(!1);let x=a.replace(/^\/*/,"/"),y=m.useMemo(()=>({basename:x,navigator:i,static:o,future:Ce({v7_relativeSplatPath:!1},h)}),[x,h,i,o]);typeof r=="string"&&(r=he(r));let{pathname:N="/",search:d="",hash:j="",state:S=null,key:w="default"}=r,b=m.useMemo(()=>{let p=xe(N,x);return p==null?null:{location:{pathname:p,search:d,hash:j,state:S,key:w},navigationType:n}},[x,N,d,j,S,w,n]);return b==null?null:m.createElement(Y.Provider,{value:y},m.createElement(_e.Provider,{children:s,value:b}))}function Ht(t){let{children:a,location:s}=t;return Gs(Xe(a),s)}new Promise(()=>{});function Xe(t,a){a===void 0&&(a=[]);let s=[];return m.Children.forEach(t,(r,n)=>{if(!m.isValidElement(r))return;let i=[...a,n];if(r.type===m.Fragment){s.push.apply(s,Xe(r.props.children,i));return}r.type!==_&&q(!1),!r.props.index||!r.props.children||q(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Xe(r.props.children,i)),s.push(o)}),s}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Te(){return Te=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},Te.apply(this,arguments)}function Kt(t,a){if(t==null)return{};var s={},r=Object.keys(t),n,i;for(i=0;i<r.length;i++)n=r[i],!(a.indexOf(n)>=0)&&(s[n]=t[n]);return s}function da(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function ma(t,a){return t.button===0&&(!a||a==="_self")&&!da(t)}const xa=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],ua=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],ha="6";try{window.__reactRouterVersion=ha}catch{}const pa=m.createContext({isTransitioning:!1}),ga="startTransition",kt=ms[ga];function fa(t){let{basename:a,children:s,future:r,window:n}=t,i=m.useRef();i.current==null&&(i.current=ws({window:n,v5Compat:!0}));let o=i.current,[h,x]=m.useState({action:o.action,location:o.location}),{v7_startTransition:y}=r||{},N=m.useCallback(d=>{y&&kt?kt(()=>x(d)):x(d)},[x,y]);return m.useLayoutEffect(()=>o.listen(N),[o,N]),m.useEffect(()=>ia(r),[r]),m.createElement(ca,{basename:a,children:s,location:h.location,navigationType:h.action,navigator:o,future:r})}const ya=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ba=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,va=m.forwardRef(function(a,s){let{onClick:r,relative:n,reloadDocument:i,replace:o,state:h,target:x,to:y,preventScrollReset:N,viewTransition:d}=a,j=Kt(a,xa),{basename:S}=m.useContext(Y),w,b=!1;if(typeof y=="string"&&ba.test(y)&&(w=y,ya))try{let u=new URL(window.location.href),l=y.startsWith("//")?new URL(u.protocol+y):new URL(y),c=xe(l.pathname,S);l.origin===u.origin&&c!=null?y=c+l.search+l.hash:b=!0}catch{}let p=Ks(y,{relative:n}),g=Na(y,{replace:o,state:h,target:x,preventScrollReset:N,relative:n,viewTransition:d});function f(u){r&&r(u),u.defaultPrevented||g(u)}return m.createElement("a",Te({},j,{href:w||p,onClick:b||i?r:f,ref:s,target:x}))}),le=m.forwardRef(function(a,s){let{"aria-current":r="page",caseSensitive:n=!1,className:i="",end:o=!1,style:h,to:x,viewTransition:y,children:N}=a,d=Kt(a,ua),j=Je(x,{relative:d.relative}),S=ge(),w=m.useContext(Bt),{navigator:b,basename:p}=m.useContext(Y),g=w!=null&&wa(j)&&y===!0,f=b.encodeLocation?b.encodeLocation(j).pathname:j.pathname,u=S.pathname,l=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;n||(u=u.toLowerCase(),l=l?l.toLowerCase():null,f=f.toLowerCase()),l&&p&&(l=xe(l,p)||l);const c=f!=="/"&&f.endsWith("/")?f.length-1:f.length;let v=u===f||!o&&u.startsWith(f)&&u.charAt(c)==="/",C=l!=null&&(l===f||!o&&l.startsWith(f)&&l.charAt(f.length)==="/"),E={isActive:v,isPending:C,isTransitioning:g},D=v?r:void 0,R;typeof i=="function"?R=i(E):R=[i,v?"active":null,C?"pending":null,g?"transitioning":null].filter(Boolean).join(" ");let B=typeof h=="function"?h(E):h;return m.createElement(va,Te({},d,{"aria-current":D,className:R,ref:s,style:B,to:x,viewTransition:y}),typeof N=="function"?N(E):N)});var et;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(et||(et={}));var Ct;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Ct||(Ct={}));function ja(t){let a=m.useContext(Be);return a||q(!1),a}function Na(t,a){let{target:s,replace:r,state:n,preventScrollReset:i,relative:o,viewTransition:h}=a===void 0?{}:a,x=Oe(),y=ge(),N=Je(t,{relative:o});return m.useCallback(d=>{if(ma(d,s)){d.preventDefault();let j=r!==void 0?r:Le(y)===Le(N);x(t,{replace:j,state:n,preventScrollReset:i,relative:o,viewTransition:h})}},[y,x,N,r,n,s,t,i,o,h])}function wa(t,a){a===void 0&&(a={});let s=m.useContext(pa);s==null&&q(!1);let{basename:r}=ja(et.useViewTransitionState),n=Je(t,{relative:a.relative});if(!s.isTransitioning)return!1;let i=xe(s.currentLocation.pathname,r)||s.currentLocation.pathname,o=xe(s.nextLocation.pathname,r)||s.nextLocation.pathname;return Pe(n.pathname,o)!=null||Pe(n.pathname,i)!=null}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Sa={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),M=(t,a)=>{const s=m.forwardRef(({color:r="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:h="",children:x,...y},N)=>m.createElement("svg",{ref:N,...Sa,width:n,height:n,stroke:r,strokeWidth:o?Number(i)*24/Number(n):i,className:["lucide",`lucide-${ka(t)}`,h].join(" "),...y},[...a.map(([d,j])=>m.createElement(d,j)),...Array.isArray(x)?x:[x]]));return s.displayName=`${t}`,s};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=M("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=M("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=M("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=M("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=M("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=M("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=M("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=M("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=M("ChefHat",[["path",{d:"M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z",key:"z3ra2g"}],["line",{x1:"6",x2:"18",y1:"17",y2:"17",key:"12q60k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=M("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=M("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=M("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=M("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=M("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=M("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=M("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=M("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=M("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=M("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=M("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=M("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=M("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=M("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=M("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=M("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=M("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const za=M("MoveDown",[["path",{d:"M8 18L12 22L16 18",key:"cskvfv"}],["path",{d:"M12 2V22",key:"r89rzk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=M("MoveUp",[["path",{d:"M8 6L12 2L16 6",key:"1yvkyx"}],["path",{d:"M12 2V22",key:"r89rzk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=M("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=M("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=M("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _a=M("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ja=M("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=M("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=M("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=M("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=M("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=M("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ha=M("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=M("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=M("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=M("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=M("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=M("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=M("UtensilsCrossed",[["path",{d:"m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8a3 3 0 0 0 4.2 0L22 8",key:"n7qcjb"}],["path",{d:"M15 15 3.3 3.3a4.2 4.2 0 0 0 0 6l7.3 7.3c.7.7 2 .7 2.8 0L15 15Zm0 0 7 7",key:"d0u48b"}],["path",{d:"m2.1 21.8 6.4-6.3",key:"yn04lh"}],["path",{d:"m19 5-7 7",key:"194lzd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=M("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"1ogz0v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=M("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Se={isEnabled:!0,orderDate:"5.22",orderWeekday:"周四",pickupTime:"18:00",orderDeadline:"5.22（周四）12:00",specialDeadline:"甜品截至5.21晚10点",pickupLocation:"蓝塔楼下",paymentMethods:["现金","PayPal"],promotionText:"本周特惠: 三份餐点八折优惠！单点饮料第二杯半价！",title:"📢 本周周五订餐公告",description:"请查看以下重要信息，以便顺利完成订餐",tips:["考虑有同学课前用餐，为方便外带食用，现提供一次性餐具（筷子 / 勺叉）！","下单时备注或私信群主，随时随地享受美味～"]},Qa=({data:t,onClose:a})=>t.isEnabled?e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 border-l-4 border-blue-500 p-3 mb-3 relative rounded-r-lg shadow-sm",children:[e.jsxs("button",{onClick:a,className:"absolute right-2 top-2 text-gray-400 hover:text-gray-600 transition-colors",children:[e.jsx("span",{className:"sr-only",children:"关闭"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsxs("div",{className:"flex items-center text-blue-700 font-bold mb-1.5",children:[e.jsx(Ca,{className:"h-4 w-4 mr-1.5 text-blue-600"}),e.jsx("h3",{className:"text-sm",children:t.title})]}),t.promotionText&&e.jsx("div",{className:"bg-yellow-50 border-l-2 border-yellow-400 p-1.5 mb-1.5 ml-6 rounded-r-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(xt,{className:"h-3.5 w-3.5 text-yellow-500 mr-1 flex-shrink-0"}),e.jsx("span",{className:"text-xs font-medium text-yellow-800",children:t.promotionText})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-1 text-xs text-gray-700 ml-6 mb-1.5",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx(Qt,{className:"h-3.5 w-3.5 mr-1.5 text-blue-500 flex-shrink-0 mt-0.5"}),e.jsxs("span",{children:["取餐时间：",e.jsxs("span",{className:"font-medium",children:[t.orderDate,"（",t.orderWeekday,"）",t.pickupTime]})]})]}),e.jsxs("div",{className:"flex items-start flex-col",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx(ee,{className:"h-3.5 w-3.5 mr-1.5 text-blue-500 flex-shrink-0 mt-0.5"}),e.jsxs("span",{children:["截单时间：",e.jsx("span",{className:"font-medium",children:t.orderDeadline})]})]}),t.specialDeadline&&e.jsx("div",{className:"ml-5 mt-0.5",children:e.jsx("span",{className:"text-orange-500 font-medium text-xs",children:t.specialDeadline})})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx(Ta,{className:"h-3.5 w-3.5 mr-1.5 text-blue-500 flex-shrink-0 mt-0.5"}),e.jsxs("span",{children:["取餐点：",e.jsx("span",{className:"font-medium",children:t.pickupLocation})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx(mt,{className:"h-3.5 w-3.5 mr-1.5 text-blue-500 flex-shrink-0 mt-0.5"}),e.jsxs("span",{children:["支付方式：",e.jsx("span",{className:"font-medium",children:t.paymentMethods.join(" / ")})]})]})]}),t.tips.length>0&&e.jsxs("div",{className:"ml-6 mt-1 bg-white p-2 rounded-lg border border-blue-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center mb-1 text-blue-700 font-medium",children:[e.jsx(ts,{className:"h-3.5 w-3.5 mr-1 text-blue-600"}),e.jsx("span",{className:"text-xs",children:"温馨提示"})]}),e.jsx("ul",{className:"space-y-0.5",children:t.tips.map((s,r)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"inline-block h-3.5 w-3.5 rounded-full bg-blue-100 text-blue-600 text-xs flex items-center justify-center mr-1.5 mt-0.5 font-bold",children:r+1}),e.jsx("span",{className:"text-gray-600 text-xs",children:s})]},r))})]})]}):null,Ot=(t,a)=>{try{const s=localStorage.getItem(t);return s?JSON.parse(s):a}catch(s){return console.error(`加载${t}数据失败:`,s),a}},Ga={name:"哥村小饭桌",logo:"https://images.pexels.com/photos/6287525/pexels-photo-6287525.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1"},Ya=({hideAnnouncement:t=!1,onAnnouncementClick:a})=>{const[s,r]=m.useState(!1),[n,i]=m.useState(!1),o=m.useRef(null),[h,x]=m.useState(()=>Ot("announcementData",Se)),[y,N]=m.useState(()=>Ot("restaurantInfo",Ga));m.useEffect(()=>{const j=()=>{r(window.scrollY>10)};return window.addEventListener("scroll",j),()=>window.removeEventListener("scroll",j)},[]),m.useEffect(()=>{const j=b=>{if(b.key==="announcementData"&&b.newValue)try{const p=JSON.parse(b.newValue);x(p)}catch(p){console.error("Error parsing announcement data:",p)}if(b.key==="restaurantInfo"&&b.newValue)try{const p=JSON.parse(b.newValue);N(p)}catch(p){console.error("Error parsing restaurant info:",p)}},S=b=>{x(b.detail)},w=b=>{N(b.detail)};return window.addEventListener("storage",j),window.addEventListener("announcementUpdate",S),window.addEventListener("restaurantInfoUpdate",w),()=>{window.removeEventListener("storage",j),window.removeEventListener("announcementUpdate",S),window.removeEventListener("restaurantInfoUpdate",w)}},[]),m.useEffect(()=>{if(o.current){const j=o.current.offsetHeight;document.documentElement.style.setProperty("--header-height",`${j}px`)}},[n,s]);const d=()=>{a?a():i(!n)};return e.jsxs("header",{ref:o,className:"sticky top-0 z-30 w-full",children:[e.jsxs("div",{className:`relative overflow-hidden transition-all duration-500 ${s?"py-3":"py-4"}`,children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-r from-orange-600 via-orange-500 to-amber-500 transition-opacity duration-300 ${s?"opacity-95":"opacity-90"}`}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-white opacity-20"}),e.jsx("div",{className:"absolute -top-10 -right-10 w-40 h-40 bg-yellow-300 rounded-full blur-3xl opacity-20"}),e.jsx("div",{className:"absolute -bottom-20 -left-10 w-40 h-40 bg-orange-600 rounded-full blur-3xl opacity-10"}),e.jsxs("div",{className:"relative flex items-center justify-between px-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-white/20 rounded-full blur-md transform scale-110"}),e.jsx("div",{className:`relative h-12 w-12 overflow-hidden rounded-full border-2 border-white shadow-lg transform hover:scale-110 transition-all duration-300 ${s?"":"ring-4 ring-white/30"}`,children:e.jsx("img",{src:y.logo,alt:y.name,className:"h-full w-full object-cover"})})]}),e.jsxs("div",{className:"ml-3 flex items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-white drop-shadow-md",children:y.name}),e.jsx(ct,{className:"ml-2 h-5 w-5 text-yellow-200 drop-shadow-md"}),e.jsx(Wa,{className:"ml-1 h-4 w-4 text-yellow-100 animate-pulse"})]})]}),e.jsx("div",{className:"flex items-center space-x-3",children:!t&&h.isEnabled&&e.jsxs("button",{onClick:d,className:"flex items-center space-x-2 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-full px-4 py-2 transition-all duration-300 border border-white/20",children:[e.jsx(st,{className:"h-5 w-5 text-white"}),e.jsx("span",{className:"text-white font-medium text-sm",children:"公告"}),n?e.jsx(Ea,{className:"h-4 w-4 text-white"}):e.jsx(dt,{className:"h-4 w-4 text-white"})]})})]}),e.jsx("div",{className:`absolute bottom-0 left-0 w-full h-[2px] bg-gradient-to-r from-transparent via-white to-transparent opacity-30 transition-opacity duration-300 ${s?"opacity-40":"opacity-20"}`})]}),!t&&n&&h.isEnabled&&e.jsx("div",{className:"w-full bg-white px-4 pt-1 pb-0 shadow-sm",children:e.jsx(Qa,{data:h,onClose:()=>i(!1)})})]})},Za=({categories:t,selectedCategory:a,onCategoryClick:s,onAnnouncementClick:r,showAnnouncement:n=!0})=>e.jsx("nav",{className:"py-4",children:e.jsxs("ul",{className:"flex flex-col space-y-1",children:[n&&e.jsx("li",{className:"mb-2",children:e.jsx("button",{onClick:r,className:`w-full px-4 py-3 text-center text-sm transition-all md:text-left md:text-base
                bg-gradient-to-r from-blue-50 to-blue-100 border-l-4 border-blue-500 
                text-blue-700 hover:from-blue-100 hover:to-blue-200 font-medium rounded-r-lg`,children:e.jsxs("div",{className:"flex items-center justify-center md:justify-start",children:[e.jsx(Ua,{className:"h-4 w-4 mr-2 text-blue-600"}),e.jsx("span",{children:"公告信息"})]})})}),t.sort((i,o)=>i.order-o.order).map(i=>e.jsx("li",{children:e.jsx("button",{onClick:()=>s(i.id),className:`w-full px-4 py-3 text-center text-sm transition-all md:text-left md:text-base ${a===i.id?"bg-orange-50 font-medium text-orange-500":"text-gray-600 hover:bg-gray-50"}`,children:i.name})},i.id))]})}),oe=(t,a)=>t?t.replace(/\s/g,"").trim():a,J={apiKey:oe("AIzaSyBwgWBxCIarv1kO0kXpUuXCAA7TaVvbqrA","AIzaSyBwgWBxCIarv1kO0kXpUuXCAA7TaVvbqrA"),authDomain:oe("gcxfz-restaurant.firebaseapp.com","gcxfz-restaurant.firebaseapp.com"),projectId:oe("	gcxfz-restaurant","gcxfz-restaurant"),storageBucket:oe("gcxfz-restaurant.firebasestorage.app","gcxfz-restaurant.firebasestorage.app"),messagingSenderId:oe("112720952941","112720952941"),appId:oe("1:112720952941:web:ab4e3dce42b152edba0964","1:112720952941:web:ab4e3dce42b152edba0964")};console.log("🔥 使用Firebase云端数据存储");console.log("🔧 Firebase配置验证:",{apiKey:J.apiKey?`${J.apiKey.substring(0,10)}...`:"undefined",authDomain:J.authDomain,projectId:J.projectId,storageBucket:J.storageBucket,messagingSenderId:J.messagingSenderId,appId:J.appId?`${J.appId.substring(0,20)}...`:"undefined"});if(!J.projectId||J.projectId.length===0)throw console.error("❌ Firebase projectId未正确配置"),new Error("Firebase projectId配置错误");if(!J.apiKey||J.apiKey.length===0)throw console.error("❌ Firebase apiKey未正确配置"),new Error("Firebase apiKey配置错误");const ss=xs(J),U=us(ss);hs(ss);console.log("🔥 Firebase已成功初始化");const z={ORDERS:"orders",MENU_ITEMS:"menuItems",CATEGORIES:"categories",SETTINGS:"settings",DELETED_ORDERS:"deletedOrders"},je={async getAllOrders(){try{const a=(await ce(ft(W(U,z.ORDERS),yt("createdAt","desc")))).docs.map(s=>{var r,n;return{id:s.id,...s.data(),createdAt:((r=s.data().createdAt)==null?void 0:r.toDate())||new Date,updatedAt:((n=s.data().updatedAt)==null?void 0:n.toDate())||new Date}});return console.log("🔥 从Firebase获取订单:",a.length),a}catch(t){throw console.error("❌ 获取订单失败:",t),new Error("无法获取订单数据，请检查网络连接")}},async createOrder(t){try{const s={id:(await $t(W(U,z.ORDERS),{...t,createdAt:ve(),updatedAt:ve()})).id,...t,createdAt:new Date,updatedAt:new Date};return console.log("🔥 订单创建成功:",s.id),s}catch(a){throw console.error("❌ 创建订单失败:",a),new Error("无法创建订单，请检查网络连接")}},async updateOrderStatus(t,a){try{await Rt(K(U,z.ORDERS,t),{status:a,updatedAt:ve()}),console.log("🔥 订单状态更新成功:",t,a)}catch(s){throw console.error("❌ 更新订单状态失败:",s),new Error("无法更新订单状态，请检查网络连接")}},async deleteOrder(t){try{await this.addToDeletedList(t),await lt(K(U,z.ORDERS,t)),console.log("✅ 订单删除成功:",t)}catch(a){throw console.error("删除订单失败:",a),a}},async addToDeletedList(t){try{await Lt(K(U,z.DELETED_ORDERS,t),{deletedAt:ve(),orderId:t})}catch(a){console.error("添加到删除列表失败:",a)}},async getDeletedOrderIds(){try{return(await ce(W(U,z.DELETED_ORDERS))).docs.map(a=>a.data().orderId)}catch(t){return console.error("获取删除列表失败:",t),[]}},subscribeToOrders(t){return ps(ft(W(U,z.ORDERS),yt("createdAt","desc")),async s=>{try{const r=await this.getDeletedOrderIds(),n=s.docs.map(i=>{var o,h;return{id:i.id,...i.data(),createdAt:((o=i.data().createdAt)==null?void 0:o.toDate())||new Date,updatedAt:((h=i.data().updatedAt)==null?void 0:h.toDate())||new Date}}).filter(i=>!r.includes(i.id));t(n)}catch(r){console.error("处理订单更新失败:",r)}},s=>{console.error("订单监听失败:",s)})}},me={async getAllMenuItems(){try{return(await ce(W(U,z.MENU_ITEMS))).docs.map(a=>({id:a.id,...a.data()}))}catch(t){return console.error("获取菜品失败:",t),[]}},async createMenuItem(t){try{return{id:(await $t(W(U,z.MENU_ITEMS),t)).id,...t}}catch(a){throw console.error("创建菜品失败:",a),a}},async updateMenuItem(t,a){try{await Rt(K(U,z.MENU_ITEMS,t),a)}catch(s){throw console.error("更新菜品失败:",s),s}},async deleteMenuItem(t){try{await lt(K(U,z.MENU_ITEMS,t))}catch(a){throw console.error("删除菜品失败:",a),a}}},H={async getSetting(t){try{const a=await gs(K(U,z.SETTINGS,t));return a.exists()?a.data().value:null}catch(a){return console.error("获取设置失败:",a),null}},async setSetting(t,a){try{await Lt(K(U,z.SETTINGS,t),{value:a,updatedAt:ve()})}catch(s){throw console.error("保存设置失败:",s),s}},async deleteSetting(t){try{await lt(K(U,z.SETTINGS,t))}catch(a){throw console.error("删除设置失败:",a),a}}},Xa={async migrateFromLocalStorage(){try{console.log("🚀 开始数据迁移...");const t=localStorage.getItem("orders");if(t){const r=JSON.parse(t),n=be(U);r.forEach(i=>{const o=K(W(U,z.ORDERS));n.set(o,{...i,createdAt:bt.fromDate(new Date(i.createdAt)),updatedAt:bt.fromDate(new Date(i.updatedAt))})}),await n.commit(),console.log(`✅ 迁移了 ${r.length} 个订单`)}const a=localStorage.getItem("menuItems");if(a){const r=JSON.parse(a),n=be(U);r.forEach(i=>{const o=K(W(U,z.MENU_ITEMS));n.set(o,i)}),await n.commit(),console.log(`✅ 迁移了 ${r.length} 个菜品`)}const s=["categories","restaurantInfo","announcementData","discounts","deletedOrders"];for(const r of s){const n=localStorage.getItem(r);n&&(await H.setSetting(r,JSON.parse(n)),console.log(`✅ 迁移了设置: ${r}`))}console.log("🎉 数据迁移完成！")}catch(t){throw console.error("❌ 数据迁移失败:",t),t}},async clearAllData(){try{console.log("🧹 开始清空Firebase数据...");const t=await ce(W(U,z.ORDERS)),a=be(U);t.docs.forEach(o=>{a.delete(o.ref)}),await a.commit();const s=await ce(W(U,z.MENU_ITEMS)),r=be(U);s.docs.forEach(o=>{r.delete(o.ref)}),await r.commit();const n=await ce(W(U,z.SETTINGS)),i=be(U);n.docs.forEach(o=>{i.delete(o.ref)}),await i.commit(),console.log("✅ Firebase数据清空完成")}catch(t){throw console.error("❌ 清空数据失败:",t),t}}},er=Object.freeze(Object.defineProperty({__proto__:null,menuService:me,migrationService:Xa,orderService:je,settingsService:H},Symbol.toStringTag,{value:"Module"})),as=m.createContext(void 0),Ne=[{id:"1",name:"热销榜",order:1},{id:"2",name:"米饭套餐",order:2},{id:"3",name:"小吃点心",order:3},{id:"4",name:"饮料",order:4}],Re=[{id:"1",name:"黄焖鸡米饭",description:"经典黄焖鸡，搭配米饭，口感鲜美",price:19.5,imageUrl:"https://images.pexels.com/photos/7593230/pexels-photo-7593230.jpeg?auto=compress&cs=tinysrgb&w=600",category:"1",available:!0,customOptions:[{type:"size",title:"份量",required:!0,options:[{id:"small",name:"小份",isDefault:!0},{id:"large",name:"大份",price:6}]}]},{id:"2",name:"回锅肉套餐",description:"香辣可口的回锅肉，搭配新鲜蔬菜和米饭",price:26,imageUrl:"https://images.pexels.com/photos/6210747/pexels-photo-6210747.jpeg?auto=compress&cs=tinysrgb&w=600",category:"2",available:!0,customOptions:[{type:"spicy",title:"辣度",required:!1,options:[{id:"mild",name:"微辣",isDefault:!0},{id:"medium",name:"中辣"},{id:"hot",name:"重辣"}]}]},{id:"3",name:"水煮鱼片",description:"麻辣鲜香的水煮鱼片，搭配新鲜青菜",price:32,imageUrl:"https://images.pexels.com/photos/5836771/pexels-photo-5836771.jpeg?auto=compress&cs=tinysrgb&w=600",category:"2",available:!0,customOptions:[{type:"spicy",title:"辣度",required:!1,options:[{id:"medium",name:"正常辣",isDefault:!0},{id:"hot",name:"重辣"},{id:"extra-hot",name:"特辣"}]}]},{id:"4",name:"煎饺",description:"外脆里嫩，精选猪肉馅料",price:15,imageUrl:"https://images.pexels.com/photos/5908252/pexels-photo-5908252.jpeg?auto=compress&cs=tinysrgb&w=600",category:"3",available:!0,customOptions:[{type:"size",title:"份量",required:!0,options:[{id:"small",name:"小份(6个)",isDefault:!0},{id:"large",name:"大份(12个)",price:3}]}]},{id:"5",name:"凉拌黄瓜",description:"清脆爽口的黄瓜，配以特制调味料",price:12,imageUrl:"https://images.pexels.com/photos/6341409/pexels-photo-6341409.jpeg?auto=compress&cs=tinysrgb&w=600",category:"3",available:!0,customOptions:[{type:"spicy",title:"口味",required:!1,options:[{id:"normal",name:"原味",isDefault:!0},{id:"spicy",name:"麻辣味",price:1}]}]},{id:"6",name:"奶茶",description:"醇香奶茶，口感丰富",price:10,imageUrl:"https://images.pexels.com/photos/4887880/pexels-photo-4887880.jpeg?auto=compress&cs=tinysrgb&w=600",category:"4",available:!0,customOptions:[{type:"size",title:"杯型",required:!0,options:[{id:"medium",name:"中杯",isDefault:!0},{id:"large",name:"大杯",price:2}]},{type:"ice",title:"冰量",required:!1,options:[{id:"normal",name:"正常冰",isDefault:!0},{id:"less",name:"少冰"},{id:"no",name:"去冰"}]},{type:"sugar",title:"甜度",required:!1,options:[{id:"normal",name:"正常甜",isDefault:!0},{id:"half",name:"半糖"},{id:"less",name:"微糖"},{id:"no",name:"无糖"}]}]},{id:"7",name:"柠檬水",description:"新鲜柠檬制作，酸甜清爽",price:8,imageUrl:"https://images.pexels.com/photos/4021983/pexels-photo-4021983.jpeg?auto=compress&cs=tinysrgb&w=600",category:"4",available:!0,customOptions:[{type:"size",title:"杯型",required:!0,options:[{id:"small",name:"小杯",isDefault:!0},{id:"large",name:"大杯",price:2}]},{type:"ice",title:"冰量",required:!1,options:[{id:"normal",name:"正常冰",isDefault:!0},{id:"less",name:"少冰"},{id:"no",name:"常温"}]},{type:"extra",title:"加料",required:!1,options:[{id:"mint",name:"薄荷叶",price:1},{id:"honey",name:"蜂蜜",price:1.5},{id:"none",name:"不加料",isDefault:!0}]}]},{id:"8",name:"宫保鸡丁",description:"传统川菜，麻辣鲜香，搭配米饭",price:24,imageUrl:"https://images.pexels.com/photos/7353379/pexels-photo-7353379.jpeg?auto=compress&cs=tinysrgb&w=600",category:"2",available:!0,customOptions:[{type:"spicy",title:"辣度",required:!1,options:[{id:"mild",name:"微辣",isDefault:!0},{id:"medium",name:"中辣"},{id:"hot",name:"重辣"}]}]}],tr=async()=>{try{console.log("🔄 正在从Firebase加载菜单数据...");const[t,a]=await Promise.all([me.getAllMenuItems(),H.getSetting("categories")]);if(t&&t.length>0)return console.log("✅ 从Firebase加载了菜单数据:",t.length,"个菜品"),{menuItems:t,categories:a||Ne};console.log("⚠️ Firebase没有菜单数据，尝试从localStorage加载...");const s=localStorage.getItem("menuItems"),r=localStorage.getItem("categories"),n={menuItems:s?JSON.parse(s):Re,categories:r?JSON.parse(r):Ne};if(n.menuItems&&n.menuItems.length>0){console.log("🚀 正在迁移菜单数据到Firebase...");try{for(const i of n.menuItems)await me.createMenuItem(i);await H.setSetting("categories",n.categories),console.log("✅ 菜单数据迁移到Firebase成功")}catch(i){console.error("❌ 菜单数据迁移失败:",i)}}return n}catch(t){console.error("❌ 加载菜单数据失败:",t);try{const a=localStorage.getItem("menuItems"),s=localStorage.getItem("categories");return{menuItems:a?JSON.parse(a):Re,categories:s?JSON.parse(s):Ne}}catch(a){return console.error("❌ 从localStorage加载菜单数据也失败:",a),{menuItems:Re,categories:Ne}}}},sr=async(t,a)=>{try{localStorage.setItem("menuItems",JSON.stringify(t)),localStorage.setItem("categories",JSON.stringify(a));try{await H.setSetting("categories",a),console.log("✅ 分类数据已保存到Firebase")}catch(r){console.error("❌ 保存分类数据到Firebase失败:",r)}const s=new CustomEvent("menuUpdate",{detail:{menuItems:t,categories:a}});window.dispatchEvent(s)}catch(s){console.error("保存菜单数据失败:",s)}},ar=({children:t})=>{const[a,s]=m.useState(!0),[r,n]=m.useState(null),[i,o]=m.useState([]),[h,x]=m.useState([]);m.useEffect(()=>{(i.length>0||h.length>0)&&sr(i,h)},[i,h]),m.useEffect(()=>{(async()=>{s(!0),n(null);try{const p=await tr();o(p.menuItems),x(p.categories)}catch(p){console.error("加载菜单数据失败:",p),n("加载菜单数据失败"),o(Re),x(Ne)}finally{s(!1)}})()},[]),m.useEffect(()=>{const b=p=>{if(p.detail){const{menuItems:g,categories:f}=p.detail;JSON.stringify(i)!==JSON.stringify(g)&&o(g),JSON.stringify(h)!==JSON.stringify(f)&&x(f)}};return window.addEventListener("menuUpdate",b),()=>{window.removeEventListener("menuUpdate",b)}},[i,h]);const y=async b=>{try{await me.createMenuItem(b),console.log("✅ 菜品已添加到Firebase:",b.name),o(p=>[...p,b])}catch(p){console.error("❌ 添加菜品到Firebase失败:",p),o(g=>[...g,b])}},N=async(b,p)=>{try{await me.updateMenuItem(b,p),console.log("✅ 菜品已更新到Firebase:",b),o(g=>g.map(f=>f.id===b?{...f,...p}:f))}catch(g){console.error("❌ 更新菜品到Firebase失败:",g),o(f=>f.map(u=>u.id===b?{...u,...p}:u))}},d=async b=>{try{await me.deleteMenuItem(b),console.log("✅ 菜品已从Firebase删除:",b),o(p=>p.filter(g=>g.id!==b))}catch(p){console.error("❌ 从Firebase删除菜品失败:",p),o(g=>g.filter(f=>f.id!==b))}},j=async b=>{try{const p=[...h,b];x(p),await H.setSetting("categories",p),console.log("✅ 分类已添加到Firebase:",b.name)}catch(p){console.error("❌ 添加分类到Firebase失败:",p)}},S=async(b,p)=>{try{const g=h.map(f=>f.id===b?{...f,...p}:f);x(g),await H.setSetting("categories",g),console.log("✅ 分类已更新到Firebase:",b)}catch(g){console.error("❌ 更新分类到Firebase失败:",g)}},w=async b=>{try{const p=h.filter(g=>g.id!==b);x(p),await H.setSetting("categories",p),console.log("✅ 分类已从Firebase删除:",b)}catch(p){console.error("❌ 从Firebase删除分类失败:",p)}};return e.jsx(as.Provider,{value:{menuItems:i,categories:h,isLoading:a,error:r,addMenuItem:y,updateMenuItem:N,deleteMenuItem:d,addCategory:j,updateCategory:S,deleteCategory:w},children:t})},De=()=>{const t=m.useContext(as);if(t===void 0)throw new Error("useMenu must be used within a MenuProvider");return t},rs=m.createContext(void 0),rr=()=>{try{const t=localStorage.getItem("cart");if(t)return JSON.parse(t)}catch(t){console.error("加载购物车数据失败:",t)}return[]},nr=t=>{try{localStorage.setItem("cart",JSON.stringify(t));const a=new CustomEvent("cartUpdate",{detail:t});window.dispatchEvent(a)}catch(a){console.error("保存购物车数据失败:",a)}},lr=({children:t})=>{const[a,s]=m.useState(rr()),[r,n]=m.useState(0),[i,o]=m.useState(0),[h,x]=m.useState({type:"",value:0,savings:0}),[y,N]=m.useState(0),{menuItems:d}=De();m.useEffect(()=>{nr(a)},[a]),m.useEffect(()=>{const g=f=>{f.detail&&JSON.stringify(a)!==JSON.stringify(f.detail)&&s(f.detail)};return window.addEventListener("cartUpdate",g),()=>{window.removeEventListener("cartUpdate",g)}},[a]),m.useEffect(()=>{if(d.length>0&&a.length>0){const g=new Set(d.map(u=>u.id)),f=a.filter(u=>g.has(u.menuItem.id));f.length!==a.length&&s(f)}},[d,a]);const j=(g,f)=>`${g.id}-${f||"default"}`,S=(g,f,u,l,c)=>{s(v=>{const C=j(g,u),E=v.findIndex(D=>D.menuItem.id===g.id&&D.variant===u&&D.special===l);if(E>=0){const D=[...v],R=D[E].quantity+f;return R<=0?D.splice(E,1):D[E]={...D[E],quantity:R},D}else if(f>0){const D={id:`${C}-${Date.now()}`,menuItem:g,quantity:f,variant:u,special:l,calculatedPrice:c};return[...v,D]}return v})},w=g=>{s(f=>f.filter(u=>u.id!==g))},b=(g,f)=>{if(f<=0){w(g);return}s(u=>u.map(l=>l.id===g?{...l,quantity:f}:l))},p=()=>{s([])};return m.useEffect(()=>{const g=a.reduce((v,C)=>v+C.quantity,0);n(g);const f=a.reduce((v,C)=>{let E=C.calculatedPrice!==void 0?C.calculatedPrice:C.menuItem.price;if(C.calculatedPrice===void 0&&C.variant&&C.menuItem.customOptions)for(const D of C.menuItem.customOptions){const R=D.options.find(B=>B.name===C.variant);if(R&&R.price!==void 0){D.title==="份量"||D.title==="杯型"||D.title==="数量"?D.options.some(ae=>ae.price===void 0)?E+=R.price:E=R.price:E+=R.price;break}}return v+E*C.quantity},0);o(f);let u=0,l="",c=0;f>=100?(l="10% off orders over €100",c=.1,u=Math.round(f*.1*10)/10):f>=200&&(l="€20 off orders over €200",c=20,u=20),x({type:l,value:c,savings:u}),N(Math.round((f-u)*10)/10)},[a]),e.jsx(rs.Provider,{value:{items:a,addItem:S,removeItem:w,updateItemQuantity:b,clearCart:p,totalItems:r,subtotal:i,discount:h,total:y},children:t})},Ee=()=>{const t=m.useContext(rs);if(t===void 0)throw new Error("useCart must be used within a CartProvider");return t},or=({isOpen:t,onClose:a,item:s,onSelectOptions:r})=>t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"relative w-full max-w-md max-h-[90vh] overflow-auto rounded-xl bg-white",children:[e.jsxs("div",{className:"relative h-80 w-full",children:[e.jsx("img",{src:s.imageUrl,alt:s.name,className:"h-full w-full object-cover"}),e.jsx("button",{className:"absolute right-3 bottom-3 flex h-10 w-10 items-center justify-center rounded-full bg-black bg-opacity-40 text-white",onClick:a,children:e.jsx(se,{size:20})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-3",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:s.name})}),e.jsx("div",{className:"mb-3 text-gray-600",children:e.jsx("p",{children:s.description})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-2xl font-bold text-orange-500",children:["€",s.price.toFixed(1)]}),s.customOptions&&s.customOptions.length>0&&e.jsx("span",{className:"ml-1 text-sm text-gray-400",children:"起"})]}),e.jsx("button",{onClick:r,className:"rounded-full bg-orange-500 px-6 py-2 text-white shadow-md hover:bg-orange-600",children:"选规格"})]})]})]})}):null,ir=({isOpen:t,onClose:a,item:s})=>{const{addItem:r}=Ee(),n=()=>{if(s.customOptions&&s.customOptions.length>0){const l=s.customOptions.find(c=>c.title==="份量"||c.title==="杯型"||c.title==="数量");if(l&&l.options.length>0){const c=l.options.find(v=>v.isDefault);return c?c.name:l.options[0].name}}return""},[i,o]=m.useState(n()),[h,x]=m.useState({}),[y,N]=m.useState(1);m.useEffect(()=>{const l={};s.customOptions&&s.customOptions.forEach(c=>{const v=c.options.find(C=>C.isDefault);v?(c.type==="checkbox"?l[c.title]=[v.id]:l[c.title]=v.id,(c.title==="份量"||c.title==="杯型"||c.title==="数量")&&o(v.name)):c.options.length>0&&(c.type==="checkbox"?l[c.title]=[]:(l[c.title]=c.options[0].id,(c.title==="份量"||c.title==="杯型"||c.title==="数量")&&o(c.options[0].name)))}),x(l),N(1)},[s]);const d=()=>{let l=s.price;return s.customOptions&&s.customOptions.forEach(c=>{const v=h[c.title];if(c.type==="checkbox"&&Array.isArray(v))v.forEach(C=>{const E=c.options.find(D=>D.id===C);E&&E.price!==void 0&&(l+=E.price)});else if(typeof v=="string"){const C=c.options.find(E=>E.id===v);C&&C.price!==void 0&&(c.title==="份量"||c.title==="杯型"||c.title==="数量"?c.options.some(D=>D.price===void 0)?l+=C.price:l=C.price:l+=C.price)}}),l*y},j=()=>{const l=[];return s.customOptions&&s.customOptions.forEach(c=>{if(c.required){const v=h[c.title];c.type==="checkbox"?(!Array.isArray(v)||v.length===0)&&l.push(c.title):v||l.push(c.title)}}),{isValid:l.length===0,missingOptions:l}},S=()=>{const l=j();if(!l.isValid){alert(`请选择必选项：${l.missingOptions.join("、")}`);return}const c=p(),v=d()/y;r(s,y,i,c,v),a()},w=()=>{N(l=>l+1)},b=()=>{N(l=>Math.max(1,l-1))},p=()=>{const l=[];return s.customOptions&&s.customOptions.forEach(c=>{var C;const v=h[c.title];if(Array.isArray(v)&&v.length>0){const E=v.map(D=>{var R;return((R=c.options.find(B=>B.id===D))==null?void 0:R.name)||D});l.push(`${c.title}: ${E.join("、")}`)}else if(typeof v=="string"){const E=((C=c.options.find(D=>D.id===v))==null?void 0:C.name)||v;l.push(`${c.title}: ${E}`)}}),l.join("、")};if(!t)return null;const g=()=>{const l=[];return s.customOptions&&s.customOptions.length>0&&s.customOptions.forEach(c=>{l.push({title:c.title,type:c.type==="checkbox"?"checkbox":"radio",required:c.required,options:c.options})}),l},f=(l,c,v,C)=>{if((l==="份量"||l==="杯型"||l==="数量")&&s.customOptions){const E=s.customOptions.find(D=>D.title===l);if(E){const D=E.options.find(R=>R.id===v);D&&o(D.name)}}x(c==="checkbox"?E=>{const D=Array.isArray(E[l])?[...E[l]]:[];if(C){if(!D.includes(v))return{...E,[l]:[...D,v]}}else return{...E,[l]:D.filter(R=>R!==v)};return E}:E=>({...E,[l]:v}))},u=(l,c)=>{let v=!1;if(l.title==="份量"||l.title==="杯型"||l.title==="数量")v=c.name===i;else if(l.type==="checkbox"){const C=h[l.title]||[];v=Array.isArray(C)&&C.includes(c.id)}else v=h[l.title]===c.id;return l.type==="checkbox"?e.jsxs("label",{className:`flex items-center space-x-2 rounded-full border px-4 py-2 text-sm transition-colors ${v?"border-orange-500 bg-orange-50 text-orange-500":"border-gray-200 text-gray-700 hover:border-gray-300"}`,children:[e.jsx("input",{type:"checkbox",checked:v,onChange:C=>f(l.title,l.type,c.id,C.target.checked),className:"h-4 w-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),e.jsxs("span",{children:[c.name," ",c.price?`+€${c.price.toFixed(1)}`:""]})]},c.id):e.jsxs("button",{onClick:()=>f(l.title,l.type,c.id),className:`rounded-full border px-4 py-2 text-sm transition-colors ${v?"border-orange-500 bg-orange-50 text-orange-500":"border-gray-200 text-gray-700 hover:border-gray-300"}`,children:[c.name,c.price!==void 0&&(l.title==="份量"||l.title==="杯型"||l.title==="数量"?l.options.some(C=>C.price===void 0)?` +€${c.price.toFixed(1)}`:` €${c.price.toFixed(1)}`:` +€${c.price.toFixed(1)}`)]},c.id)};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black bg-opacity-50 sm:items-center",children:e.jsxs("div",{className:"relative w-full max-h-[85vh] overflow-auto rounded-t-xl bg-white sm:max-w-md sm:rounded-xl",children:[e.jsxs("div",{className:"sticky top-0 flex items-center justify-between border-b border-gray-100 bg-white p-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:s.name}),e.jsx("button",{onClick:a,className:"rounded-full p-1 text-gray-500 hover:bg-gray-100",children:e.jsx(se,{size:20})})]}),e.jsxs("div",{className:"p-4",children:[g().map((l,c)=>e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"mb-3 text-lg font-medium text-gray-800",children:[l.title,l.required&&e.jsx("span",{className:"ml-1 text-sm text-red-500",children:"*"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:l.options.map(v=>u(l,v))})]},c)),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"mb-3 text-lg font-medium text-gray-800",children:"数量"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:b,className:"flex h-10 w-10 items-center justify-center rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 transition-colors",disabled:y<=1,children:e.jsx(Yt,{className:"h-4 w-4"})}),e.jsx("span",{className:"text-xl font-medium text-gray-800 min-w-[40px] text-center",children:y}),e.jsx("button",{onClick:w,className:"flex h-10 w-10 items-center justify-center rounded-full bg-orange-500 text-white hover:bg-orange-600 transition-colors",children:e.jsx(Q,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"sticky bottom-0 flex items-center justify-between border-t border-gray-100 bg-white p-4",children:[e.jsx("div",{children:e.jsxs("span",{className:"text-2xl font-bold text-orange-500",children:["€",d().toFixed(1)]})}),e.jsx("button",{onClick:S,className:"rounded-full bg-orange-500 px-6 py-2 text-white shadow-md hover:bg-orange-600",children:"加入购物车"})]})]})})},cr=({item:t})=>{const{addItem:a,items:s}=Ee(),[r,n]=m.useState(!1),[i,o]=m.useState(!1),[h,x]=m.useState(0),y=m.useRef(null),N=m.useRef(null),d=()=>t.customOptions&&t.customOptions.length>0;m.useEffect(()=>{if(d())x(0);else{const l=s.filter(c=>c.menuItem.id===t.id&&!c.variant).reduce((c,v)=>c+v.quantity,0);x(l)}},[s,t.id,d]);const j=()=>{if(t.customOptions&&t.customOptions.length>0){for(const l of t.customOptions)if(l.title==="份量"||l.title==="杯型"||l.title==="数量"){const c=l.options.find(v=>v.isDefault);if(c)return c.price!==void 0?c.price:t.price}for(const l of t.customOptions){const c=l.options.find(v=>v.isDefault&&v.price!==void 0);if(c&&c.price!==void 0)return c.price}for(const l of t.customOptions){const c=l.options.find(v=>v.price!==void 0);if(c&&c.price!==void 0)return l.title==="份量"||l.title==="杯型"||l.title==="数量"?c.price:t.price+c.price}}return t.price},S=()=>{if(!y.current||!N.current)return;const l=N.current.getBoundingClientRect(),c={x:l.left+l.width/2,y:l.top+l.height/2},v=new CustomEvent("add-to-cart",{detail:{productImage:t.imageUrl,position:c}});window.dispatchEvent(v),y.current&&(y.current.classList.add("scale-90"),setTimeout(()=>{y.current&&y.current.classList.remove("scale-90")},150))},w=l=>{l.stopPropagation(),a(t,1),S()},b=l=>{l.stopPropagation(),a(t,1)},p=l=>{l.stopPropagation(),h>0&&a(t,-1)},g=()=>{n(!0)},f=l=>{l.stopPropagation(),o(!0)},u=()=>d()?e.jsx("button",{onClick:f,className:"rounded-md bg-orange-500 text-white px-3 py-1.5 text-sm font-medium hover:bg-orange-600 transition-colors",children:"选择"}):h===0?e.jsx("button",{ref:y,onClick:w,className:"flex h-7 w-7 items-center justify-center rounded-full bg-orange-500 text-white hover:bg-orange-600 transition-transform duration-150 shadow-sm",children:e.jsx(Q,{className:"h-4 w-4"})}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:p,className:"flex h-7 w-7 items-center justify-center rounded-full bg-gray-300 text-gray-700 hover:bg-gray-400 transition-colors",children:e.jsx(Yt,{className:"h-3 w-3"})}),e.jsx("span",{className:"text-sm font-medium text-gray-800 min-w-[20px] text-center",children:h}),e.jsx("button",{ref:y,onClick:b,className:"flex h-7 w-7 items-center justify-center rounded-full bg-orange-500 text-white hover:bg-orange-600 transition-colors",children:e.jsx(Q,{className:"h-3 w-3"})})]});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex cursor-pointer items-start gap-3 border-b border-gray-100 py-4",onClick:g,children:[e.jsx("div",{className:"relative w-24 h-24 overflow-hidden rounded-lg",children:e.jsx("img",{ref:N,src:t.imageUrl,alt:t.name,className:"h-full w-full object-cover"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-gray-800 text-base mb-1",children:t.name}),e.jsx("p",{className:"text-xs text-gray-500 line-clamp-2 mb-2",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between pr-2",children:[e.jsxs("div",{className:"text-orange-500 font-semibold",children:["€",j().toFixed(1),d()&&e.jsx("span",{className:"text-xs ml-0.5",children:"起"})]}),e.jsx("div",{className:"ml-4",children:u()})]})]})]}),e.jsx(or,{isOpen:r,onClose:()=>n(!1),item:t,onSelectOptions:()=>{n(!1),o(!0)}}),e.jsx(ir,{isOpen:i,onClose:()=>o(!1),item:t})]})},dr=({menuItems:t,categories:a,categoryRefs:s})=>{const r={};t.forEach(i=>{r[i.category]||(r[i.category]=[]),i.available&&r[i.category].push(i)});const n=i=>{const o=["from-orange-500 to-amber-400","from-emerald-500 to-teal-400","from-blue-500 to-cyan-400","from-purple-500 to-violet-400"];return o[i%o.length]};return e.jsx("div",{className:"pb-4",children:a.sort((i,o)=>i.order-o.order).map((i,o)=>{var h;return e.jsxs("div",{ref:x=>s.current[i.id]=x,className:"mb-6 pt-4 scroll-mt-20",children:[e.jsx("div",{className:"relative mb-4",children:e.jsxs("div",{className:"flex items-center py-2 px-4",children:[e.jsx("div",{className:`flex items-center justify-center h-6 w-6 rounded-full bg-gradient-to-r ${n(o)} shadow-md mr-2`,children:e.jsx(ts,{className:"h-3 w-3 text-white"})}),e.jsx("h2",{className:"text-base font-bold text-gray-800",children:i.name})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[(h=r[i.id])==null?void 0:h.map(x=>e.jsx(cr,{item:x},x.id)),(!r[i.id]||r[i.id].length===0)&&e.jsx("p",{className:"text-center text-gray-500 py-4",children:"该分类暂无菜品"})]})]},i.id)})})},mr=({isOpen:t,onClose:a,onCheckout:s})=>{const{items:r,updateItemQuantity:n,removeItem:i,subtotal:o,discount:h,total:x}=Ee();return t?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/30 transition-opacity",onClick:a}),e.jsxs("div",{className:"absolute right-0 top-0 flex h-full w-full max-w-md flex-col bg-white shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-100 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ue,{className:"mr-2 h-5 w-5 text-orange-500"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"购物车"})]}),e.jsx("button",{onClick:a,className:"rounded-full p-1 text-gray-400 transition-colors hover:bg-gray-100 hover:text-gray-500",children:e.jsx(se,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:r.length===0?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-center",children:[e.jsx(ue,{className:"mb-4 h-12 w-12 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium text-gray-600",children:"购物车是空的"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"添加一些美味的菜品开始点餐吧！"}),e.jsx("button",{onClick:a,className:"mt-6 rounded-full bg-orange-500 px-6 py-2 text-sm font-medium text-white hover:bg-orange-600",children:"去点餐"})]}):e.jsx("ul",{className:"space-y-4",children:r.map(y=>{let N=y.calculatedPrice!==void 0?y.calculatedPrice:y.menuItem.price;if(y.calculatedPrice===void 0&&y.variant&&y.menuItem.customOptions)for(const d of y.menuItem.customOptions){const j=d.options.find(S=>S.name===y.variant);if(j&&j.price!==void 0){d.title==="份量"||d.title==="杯型"||d.title==="数量"?d.options.some(w=>w.price===void 0)?N+=j.price:N=j.price:N+=j.price;break}}return e.jsxs("li",{className:"flex gap-3 rounded-lg border border-gray-100 bg-white p-3",children:[e.jsx("div",{className:"h-16 w-16 flex-shrink-0 overflow-hidden rounded-md",children:e.jsx("img",{src:y.menuItem.imageUrl,alt:y.menuItem.name,className:"h-full w-full object-cover"})}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-800",children:y.menuItem.name}),e.jsxs("p",{className:"text-sm font-medium text-gray-700",children:["€",(N*y.quantity).toFixed(1)]})]}),y.variant&&y.variant.trim()!==""&&e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["规格：",y.variant]}),y.special&&y.special.trim()!==""&&e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["备注：",y.special]}),e.jsxs("div",{className:"mt-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>n(y.id,y.quantity-1),className:"flex h-6 w-6 items-center justify-center rounded-full border border-gray-200 text-gray-600 hover:bg-gray-50",children:e.jsx("span",{className:"text-lg leading-none",children:"-"})}),e.jsx("span",{className:"w-5 text-center text-sm",children:y.quantity}),e.jsx("button",{onClick:()=>n(y.id,y.quantity+1),className:"flex h-6 w-6 items-center justify-center rounded-full border border-gray-200 text-gray-600 hover:bg-gray-50",children:e.jsx("span",{className:"text-lg leading-none",children:"+"})})]}),e.jsx("button",{onClick:()=>i(y.id),className:"text-red-500 hover:text-red-600",children:e.jsx(es,{className:"h-4 w-4"})})]})]})]},y.id)})})}),r.length>0&&e.jsxs("div",{className:"border-t border-gray-100 bg-gray-50 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"小计"}),e.jsxs("span",{className:"font-medium",children:["€",o.toFixed(1)]})]}),h.type&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-green-600",children:h.type}),e.jsxs("span",{className:"font-medium text-green-600",children:["-€",h.savings.toFixed(1)]})]}),e.jsxs("div",{className:"flex justify-between border-t border-gray-200 pt-2 text-base font-semibold",children:[e.jsx("span",{children:"总计"}),e.jsxs("span",{className:"text-orange-600",children:["€",x.toFixed(1)]})]})]}),e.jsx("button",{onClick:s,className:"mt-4 w-full rounded-full bg-orange-500 py-3 text-center font-semibold text-white transition-colors hover:bg-orange-600",children:"去结算"})]})]})]}):null},xr=({isOpen:t,onClose:a,onSubmit:s})=>{const{items:r,subtotal:n,discount:i,total:o}=Ee(),[h,x]=m.useState(""),[y,N]=m.useState(""),[d,j]=m.useState(""),S=w=>{if(w.preventDefault(),!h.trim()){j("请输入群昵称");return}j(""),s(h.trim(),y.trim()||void 0)};return t?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 transition-opacity",onClick:a}),e.jsxs("div",{className:"absolute right-0 top-0 flex h-full w-full max-w-md flex-col bg-white shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-100 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ue,{className:"mr-2 h-5 w-5 text-orange-500"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"订单信息"})]}),e.jsx("button",{onClick:a,className:"rounded-full p-1 text-gray-400 transition-colors hover:bg-gray-100 hover:text-gray-500",children:e.jsx(se,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"groupName",className:"block text-sm font-medium text-gray-700 mb-2",children:["群昵称 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"groupName",value:h,onChange:w=>x(w.target.value),placeholder:"请输入您的群昵称",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"}),d&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:d})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-2",children:"备注（可选）"}),e.jsx("textarea",{id:"notes",value:y,onChange:w=>N(w.target.value),placeholder:"请输入备注信息（如特殊要求等）",rows:3,className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500 resize-none"})]}),e.jsxs("div",{className:"rounded-lg bg-gray-50 p-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-800 mb-3",children:"订单摘要"}),e.jsx("div",{className:"space-y-3",children:r.map(w=>{let b=w.calculatedPrice!==void 0?w.calculatedPrice:w.menuItem.price;if(w.calculatedPrice===void 0&&w.variant&&w.menuItem.customOptions)for(const p of w.menuItem.customOptions){const g=p.options.find(f=>f.name===w.variant);if(g&&g.price!==void 0){p.title==="份量"||p.title==="杯型"||p.title==="数量"?p.options.some(u=>u.price===void 0)?b+=g.price:b=g.price:b+=g.price;break}}return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 bg-white",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:w.menuItem.name}),e.jsxs("p",{className:"text-xs text-gray-600",children:["单价: €",b.toFixed(1)," × ",w.quantity]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["€",(b*w.quantity).toFixed(1)]})})]}),(w.variant||w.special)&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[w.variant&&w.variant.trim()!==""&&e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"规格: "}),e.jsx("span",{className:"text-xs text-gray-700",children:w.variant})]}),w.special&&w.special.trim()!==""&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"选项: "}),e.jsx("span",{className:"text-xs text-gray-700",children:w.special})]})]})]},w.id)})}),e.jsxs("div",{className:"mt-3 space-y-1 border-t border-gray-200 pt-2",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600",children:"小计"}),e.jsxs("span",{className:"font-medium",children:["€",n.toFixed(1)]})]}),i.type&&e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-green-600",children:i.type}),e.jsxs("span",{className:"font-medium text-green-600",children:["-€",i.savings.toFixed(1)]})]}),e.jsxs("div",{className:"flex justify-between text-sm font-semibold border-t border-gray-200 pt-1",children:[e.jsx("span",{children:"总计"}),e.jsxs("span",{className:"text-orange-600",children:["€",o.toFixed(1)]})]})]})]})]})}),e.jsx("div",{className:"border-t border-gray-100 bg-gray-50 p-4",children:e.jsx("button",{onClick:S,className:"w-full rounded-full bg-orange-500 py-3 text-center font-semibold text-white transition-colors hover:bg-orange-600",children:"提交订单"})})]})]}):null},ur=({order:t,onClose:a})=>e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center overflow-y-auto overflow-x-hidden",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 transition-opacity",onClick:a}),e.jsxs("div",{className:"relative mx-auto max-w-md transform overflow-hidden rounded-lg bg-white p-6 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg",children:[e.jsx("div",{className:"absolute right-4 top-4",children:e.jsx("button",{onClick:a,className:"rounded-full p-1 text-gray-400 transition-colors hover:bg-gray-100 hover:text-gray-500",children:e.jsx(se,{className:"h-6 w-6"})})}),e.jsx("div",{className:"mx-auto mb-6 flex h-16 w-16 items-center justify-center rounded-full bg-green-100",children:e.jsx(Gt,{className:"h-8 w-8 text-green-600"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"订单已提交"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"您的订单已成功提交，请留意取餐码"})]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"群昵称"}),e.jsx("p",{className:"mt-1 text-lg font-bold text-gray-900",children:t.groupName||"未填写"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"rounded-lg bg-orange-50 px-8 py-6 text-center",children:[e.jsx("p",{className:"text-sm font-medium text-orange-800",children:"取餐码"}),e.jsx("p",{className:"mt-2 text-4xl font-bold tracking-wide text-orange-600",children:t.pickupCode}),e.jsx("p",{className:"mt-1 text-xs text-orange-700",children:"请向店员出示此码或报群昵称"})]})}),t.notes&&e.jsxs("div",{className:"rounded-lg bg-gray-50 p-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"备注"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:t.notes})]})]}),e.jsxs("div",{className:"mt-6 border-t border-gray-200 pt-4",children:[e.jsx("h4",{className:"text-base font-semibold text-gray-900",children:"订单详情"}),e.jsx("div",{className:"mt-4 space-y-4",children:t.items.map(s=>{let r=s.calculatedPrice!==void 0?s.calculatedPrice:s.menuItem.price;if(s.calculatedPrice===void 0&&s.variant&&s.menuItem.customOptions)for(const n of s.menuItem.customOptions){const i=n.options.find(o=>o.name===s.variant);if(i&&i.price!==void 0){n.title==="份量"||n.title==="杯型"||n.title==="数量"?n.options.some(h=>h.price===void 0)?r+=i.price:r=i.price:r+=i.price;break}}return e.jsxs("div",{className:"border border-gray-100 rounded-lg p-3 bg-white",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:s.menuItem.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["单价: €",r.toFixed(1)," × ",s.quantity]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-medium text-gray-900",children:["€",(r*s.quantity).toFixed(1)]})})]}),(s.variant||s.special)&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-100",children:[s.variant&&s.variant.trim()!==""&&e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"规格选择: "}),e.jsx("span",{className:"text-xs text-gray-700",children:s.variant})]}),s.special&&s.special.trim()!==""&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"详细选项: "}),e.jsx("span",{className:"text-xs text-gray-700",children:s.special})]})]})]},s.id)})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"商品小计"}),e.jsxs("span",{className:"font-medium",children:["€",t.subtotal.toFixed(1)]})]}),t.discount>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-green-600",children:"优惠金额"}),e.jsxs("span",{className:"font-medium text-green-600",children:["-€",t.discount.toFixed(1)]})]}),e.jsxs("div",{className:"flex justify-between text-base font-bold pt-2 border-t border-gray-200",children:[e.jsx("span",{children:"订单总计"}),e.jsxs("span",{className:"text-orange-600",children:["€",t.total.toFixed(1)]})]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:a,className:"w-full rounded-full bg-orange-500 py-3 text-center font-medium text-white transition-all hover:bg-orange-600",children:"返回菜单"})})]})]}),hr="2.0.0",pr=({data:t,isOpen:a,onClose:s,onOrderNow:r})=>{if(!a)return null;const n=t;return e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 transition-opacity",onClick:s}),e.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto mx-4",children:[e.jsx("button",{onClick:s,className:"absolute right-3 top-3 text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx(se,{className:"h-5 w-5"})}),e.jsxs("div",{className:"p-4 pb-2 bg-gradient-to-r from-blue-500 to-blue-600 rounded-t-lg",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:t.title||`📢 本周${t.orderWeekday}订餐公告`}),e.jsx("p",{className:"text-blue-100 text-sm",children:t.description||"请查看以下重要信息，以便顺利完成订餐"})]}),e.jsxs("div",{className:"p-4 pt-3",children:[n.promotionText&&e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-2 mb-3 rounded-r-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(xt,{className:"h-4 w-4 text-yellow-500 mr-1.5 flex-shrink-0"}),e.jsx("span",{className:"font-medium text-yellow-800 text-sm",children:n.promotionText})]})}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 mb-3 border border-blue-100",children:[e.jsx("h4",{className:"font-semibold text-blue-700 mb-1.5 text-sm",children:"基本信息"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"w-20 text-xs text-gray-600 mt-0.5",children:"取餐时间："}),e.jsxs("span",{className:"font-medium text-gray-900 text-sm",children:[t.orderDate,"（",t.orderWeekday,"）",t.pickupTime]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"w-20 text-xs text-gray-600 mt-0.5",children:"截单时间："}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium text-gray-900 text-sm",children:t.orderDeadline}),t.specialDeadline&&e.jsx("span",{className:"text-orange-500 font-medium text-xs",children:t.specialDeadline})]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"w-20 text-xs text-gray-600 mt-0.5",children:"取餐地点："}),e.jsx("span",{className:"font-medium text-gray-900 text-sm",children:t.pickupLocation})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"w-20 text-xs text-gray-600 mt-0.5",children:"支付方式："}),e.jsx("span",{className:"font-medium text-gray-900 text-sm",children:t.paymentMethods.join(" / ")})]})]})]}),t.tips.length>0&&e.jsxs("div",{className:"bg-amber-50 rounded-lg p-3 border border-amber-100",children:[e.jsx("h4",{className:"font-semibold text-amber-700 mb-1 text-sm",children:"温馨提示"}),e.jsx("ul",{className:"space-y-0.5",children:t.tips.map((i,o)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"flex-shrink-0 h-4 w-4 rounded-full bg-amber-100 text-amber-700 text-xs flex items-center justify-center mr-1.5 mt-0.5 font-bold",children:o+1}),e.jsx("span",{className:"text-gray-700 text-xs",children:i})]},o))})]}),e.jsx("div",{className:"mt-3 flex justify-center",children:e.jsx("button",{onClick:r,className:"w-full px-4 py-2.5 bg-orange-500 text-white font-medium rounded-md text-sm shadow-sm hover:bg-orange-600 transition-colors",children:"去点餐"})}),e.jsx("div",{className:"hidden",children:hr})]})]})]})},gr=({isActive:t,productImage:a,startPosition:s,endPosition:r,onAnimationEnd:n})=>{const[i,o]=m.useState(s),[h,x]=m.useState(1),[y,N]=m.useState(1),[d,j]=m.useState(0);return m.useEffect(()=>{if(!t)return;console.log("飞入动画起点:",s),console.log("飞入动画终点:",r);const S=800,w=Date.now(),b=()=>{const p=Date.now()-w,g=Math.min(p/S,1),f=1-Math.pow(1-g,4),u=s.x+(r.x-s.x)*f,l=s.y+(r.y-s.y)*f,c=Math.sin(g*Math.PI)*Math.min(150,Math.abs(s.x-r.x)*.3),v=Math.sin(g*Math.PI*2)*15;j(v),o({x:u,y:l-c});const C=g>.8?Math.sin((g-.8)*5*Math.PI)*.1:0;x(1-f*.5+C),g>.7&&N(1-(g-.7)*3.3),g<1?requestAnimationFrame(b):setTimeout(()=>{n()},100)};requestAnimationFrame(b)},[t,s,r,n]),t?e.jsx("div",{className:"fixed z-50 pointer-events-none",style:{left:`${i.x}px`,top:`${i.y}px`,transform:`translate(-50%, -50%) scale(${h}) rotate(${d}deg)`,opacity:y,transition:"none"},children:e.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden shadow-lg",children:e.jsx("img",{src:a,alt:"添加到购物车",className:"w-full h-full object-cover"})})}):null},ns=m.createContext(void 0),fr=({children:t})=>{const[a,s]=m.useState(!1),[r,n]=m.useState(null),i=async(h,x)=>{try{const N=[{id:"1",username:"sjw",password:"123456"},{id:"2",username:"xsm",password:"123456"}].find(d=>d.username.toLowerCase()===h.toLowerCase()&&d.password===x);return N?(n({id:N.id,username:N.username}),s(!0),localStorage.setItem("isAuthenticated","true"),localStorage.setItem("user",JSON.stringify({id:N.id,username:N.username})),!0):!1}catch(y){return console.error("Login error:",y),!1}},o=()=>{n(null),s(!1),localStorage.removeItem("isAuthenticated"),localStorage.removeItem("user")};return qe.useEffect(()=>{const h=localStorage.getItem("isAuthenticated"),x=localStorage.getItem("user");h==="true"&&x&&(s(!0),n(JSON.parse(x)))},[]),e.jsx(ns.Provider,{value:{isAuthenticated:a,user:r,login:i,logout:o},children:t})},Ie=()=>{const t=m.useContext(ns);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},ls=()=>{const[t,a]=m.useState(""),[s,r]=m.useState(""),[n,i]=m.useState(""),[o,h]=m.useState(!1),{login:x}=Ie(),y=Oe(),N=async d=>{if(d.preventDefault(),!o){i(""),h(!0);try{await x(t,s)?y("/admin/dashboard",{replace:!0}):i("用户名或密码错误")}catch{i("登录失败，请稍后再试")}finally{h(!1)}}};return e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gray-50 px-4 py-12 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"w-full max-w-md space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-bold tracking-tight text-gray-900",children:"管理员登录"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"请输入您的管理员账号和密码"})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:N,children:[n&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-red-800",children:n})})]})}),e.jsxs("div",{className:"space-y-4 rounded-md shadow-sm",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"sr-only",children:"用户名"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx(ut,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"username",name:"username",type:"text",required:!0,value:t,onChange:d=>a(d.target.value),disabled:o,className:"block w-full rounded-md border-0 py-2 pl-10 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-orange-500 disabled:bg-gray-50 disabled:text-gray-500 disabled:ring-gray-200 sm:text-sm",placeholder:"用户名"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only",children:"密码"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx(Pa,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"password",name:"password",type:"password",required:!0,value:s,onChange:d=>r(d.target.value),disabled:o,className:"block w-full rounded-md border-0 py-2 pl-10 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-orange-500 disabled:bg-gray-50 disabled:text-gray-500 disabled:ring-gray-200 sm:text-sm",placeholder:"密码"})]})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:o,className:"group relative flex w-full justify-center rounded-md bg-orange-600 px-3 py-2 text-sm font-semibold text-white hover:bg-orange-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-orange-600 disabled:bg-orange-300",children:o?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"})}),"正在登录..."]}):"登录"})}),e.jsx("div",{className:"text-center text-sm",children:e.jsx("div",{className:"rounded-lg bg-gray-50 p-4",children:e.jsx("p",{className:"text-gray-600",children:"请使用您的管理员账户登录系统"})})})]})]})})},yr="modulepreload",br=function(t){return"/gcxfz/"+t},Dt={},vr=function(a,s,r){let n=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),h=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=Promise.allSettled(s.map(x=>{if(x=br(x),x in Dt)return;Dt[x]=!0;const y=x.endsWith(".css"),N=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${N}`))return;const d=document.createElement("link");if(d.rel=y?"stylesheet":yr,y||(d.as="script"),d.crossOrigin="",d.href=x,h&&d.setAttribute("nonce",h),document.head.appendChild(d),y)return new Promise((j,S)=>{d.addEventListener("load",j),d.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${x}`)))})}))}function i(o){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=o,window.dispatchEvent(h),!h.defaultPrevented)throw o}return n.then(o=>{for(const h of o||[])h.status==="rejected"&&i(h.reason);return a().catch(i)})};var jr={};const os=m.createContext(void 0),Nr=()=>jr.VITE_USE_FIREBASE==="true",Et=()=>{try{const t=localStorage.getItem("orders"),a=localStorage.getItem("deletedOrders");let s=[],r=[];t&&(s=JSON.parse(t),s=s.map(i=>({...i,groupName:i.groupName||"未知群昵称",notes:i.notes||void 0}))),a&&(r=JSON.parse(a));const n=s.filter(i=>!r.includes(i.id));return console.log(`📥 加载订单数据: 原始${s.length}个，过滤掉${s.length-n.length}个已删除，最终${n.length}个`),n}catch(t){console.error("加载订单数据失败:",t)}return[]},wr=t=>{try{console.log("💾 saveOrdersToStorage 被调用，订单数量:",t.length),localStorage.setItem("orders",JSON.stringify(t)),console.log("✅ 订单数据已保存到localStorage")}catch(a){console.error("❌ 保存订单数据失败:",a)}},Sr=t=>{try{const a=localStorage.getItem("deletedOrders");let s=a?JSON.parse(a):[];s.includes(t)||(s.push(t),localStorage.setItem("deletedOrders",JSON.stringify(s)),console.log(`🗑️ 订单 ${t} 已添加到删除列表，当前删除列表长度: ${s.length}`))}catch(a){console.error("❌ 添加到删除列表失败:",a)}},It=()=>{try{const t=localStorage.getItem("deletedOrders");if(t){let a=JSON.parse(t);a.length>100&&(a=a.slice(-100),localStorage.setItem("deletedOrders",JSON.stringify(a)),console.log("🧹 清理删除记录，保留最新100个"))}}catch(t){console.error("❌ 清理删除记录失败:",t)}},kr=({children:t})=>{const[a,s]=m.useState([]),[r,n]=m.useState(!1),[i,o]=m.useState(null);m.useEffect(()=>((async()=>{if(Nr()){console.log("🔥 使用Firebase模式"),n(!0);try{const p=je.subscribeToOrders(g=>{console.log("📥 Firebase订单更新:",g.length),s(g)});o(()=>p)}catch(p){console.error("❌ Firebase初始化失败，回退到localStorage:",p),n(!1),s(Et())}}else console.log("💾 使用localStorage模式"),n(!1),s(Et()),It()})(),()=>{i&&i()}),[]),m.useEffect(()=>{r||wr(a)},[a,r]),m.useEffect(()=>{if(!r){const b=p=>{if(console.log("📡 收到orderUpdate事件，detail:",p.detail),p.detail===null||Array.isArray(p.detail)&&p.detail.length===0){console.log("🗑️ 清空订单数据"),s([]);return}if(p.detail&&Array.isArray(p.detail))try{const g=localStorage.getItem("deletedOrders"),f=g?JSON.parse(g):[],u=p.detail.filter(l=>!f.includes(l.id));console.log(`🔄 过滤外部事件数据: 原始${p.detail.length}个，过滤后${u.length}个`),JSON.stringify(a)!==JSON.stringify(u)&&(console.log("🔄 更新订单数据"),s(u))}catch(g){console.error("❌ 处理外部事件失败:",g)}};return window.addEventListener("orderUpdate",b),()=>{window.removeEventListener("orderUpdate",b)}}},[a,r]);const h=()=>{const b=new Date,p=b.getFullYear().toString()+(b.getMonth()+1).toString().padStart(2,"0")+b.getDate().toString().padStart(2,"0"),g=new Date(b);g.setHours(0,0,0,0);const f=new Date(b);f.setHours(23,59,59,999);const l=(a.filter(c=>{const v=c.createdAt instanceof Date?c.createdAt:new Date(c.createdAt);return v>=g&&v<=f}).length+1).toString().padStart(3,"0");return`${p}${l}`},x=async(b,p,g,f,u,l)=>{console.log("🍕 OrderContext.createOrder 被调用，参数:",{items:b.length,total:p,subtotal:g,discount:f,groupName:u,notes:l});const c=new Date,v={items:b,total:p,subtotal:g,discount:f,status:"pending",pickupCode:h(),groupName:u,notes:l,createdAt:c,updatedAt:c};if(r)try{return await je.createOrder(v)}catch(C){throw console.error("❌ Firebase创建订单失败:",C),C}else{const C={id:`order-${c.getTime()}`,...v};return s(E=>[...E,C]),C}},y=async(b,p)=>{if(r)try{await je.updateOrderStatus(b,p)}catch(g){throw console.error("❌ Firebase更新订单状态失败:",g),g}else s(g=>g.map(f=>f.id===b?{...f,status:p,updatedAt:new Date}:f))},N=async b=>{if(console.log("🗑️ 删除订单:",b),r)try{await je.deleteOrder(b)}catch(p){throw console.error("❌ Firebase删除订单失败:",p),p}else Sr(b),s(p=>{const g=p.filter(f=>f.id!==b);console.log("💾 删除后订单数量:",g.length);try{localStorage.setItem("orders",JSON.stringify(g)),console.log("✅ 删除操作已同步到localStorage")}catch(f){console.error("❌ 删除操作同步失败:",f)}return g}),setTimeout(()=>{It()},1e3)},d=b=>{const p=new Date(b);p.setHours(0,0,0,0);const g=new Date(b);return g.setHours(23,59,59,999),a.filter(f=>{const u=f.createdAt instanceof Date?f.createdAt:new Date(f.createdAt);return u>=p&&u<=g})},j=b=>a.find(p=>p.id===b),S=async()=>{if(console.log("🧹 手动清理所有订单和删除记录"),r)try{console.log("Firebase清理功能待实现")}catch(b){throw console.error("❌ Firebase清理失败:",b),b}else s([]),localStorage.removeItem("orders"),localStorage.removeItem("deletedOrders")},w=async()=>{try{console.log("🚀 开始迁移数据到Firebase...");const{migrationService:b}=await vr(async()=>{const{migrationService:p}=await Promise.resolve().then(()=>er);return{migrationService:p}},void 0);await b.migrateFromLocalStorage(),console.log("✅ 数据迁移完成")}catch(b){throw console.error("❌ 数据迁移失败:",b),b}};return e.jsx(os.Provider,{value:{orders:a,createOrder:x,updateOrderStatus:y,deleteOrder:N,getOrdersByDate:d,getOrderById:j,clearAllOrders:S,migrateToFirebase:w},children:t})},fe=()=>{const t=m.useContext(os);if(t===void 0)throw new Error("useOrder must be used within an OrderProvider");return t},Cr=()=>{const{logout:t,user:a}=Ie(),{orders:s}=fe(),r=Oe(),[n,i]=m.useState(!1),o=()=>{t(),r("/admin/login",{replace:!0})},h=qe.useMemo(()=>{const d=new Date,j=new Date(d.getTime()-24*60*60*1e3),S=s.filter(p=>new Date(p.createdAt)>=j),w=s.filter(p=>p.status==="pending"),b=s.slice(-5).reverse();return{pendingCount:w.length,recentCount:S.length,latestOrders:b}},[s]);m.useEffect(()=>{const d=()=>{i(!1)};return n&&document.addEventListener("click",d),()=>{document.removeEventListener("click",d)}},[n]);const x=d=>(d instanceof Date?d:new Date(d)).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),y=d=>{switch(d){case"pending":return"待处理";case"preparing":return"制作中";case"ready":return"可取餐";case"completed":return"已完成";case"cancelled":return"已取消";default:return"未知状态"}},N=d=>{switch(d){case"pending":return"bg-yellow-100 text-yellow-800";case"preparing":return"bg-blue-100 text-blue-800";case"ready":return"bg-green-100 text-green-800";case"completed":return"bg-gray-100 text-gray-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return e.jsx("header",{className:"z-10 border-b border-gray-200 bg-white shadow-sm",children:e.jsxs("div",{className:"flex h-16 items-center justify-between px-4",children:[e.jsx("div",{className:"flex items-center"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:d=>{d.stopPropagation(),i(!n)},className:"relative rounded-full bg-gray-100 p-2 text-gray-600 hover:bg-gray-200 transition-colors",children:[e.jsx(st,{className:"h-5 w-5"}),h.pendingCount>0&&e.jsx("span",{className:"absolute -top-1 -right-1 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-xs font-bold text-white",children:h.pendingCount})]}),n&&e.jsx("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-50",onClick:d=>d.stopPropagation(),children:e.jsxs("div",{className:"py-1",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200 bg-gray-50 rounded-t-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"订单通知"}),e.jsx("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ee,{className:"h-3 w-3"}),"待处理: ",h.pendingCount]})})]})}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:h.latestOrders.length===0?e.jsxs("div",{className:"px-4 py-8 text-center text-gray-500",children:[e.jsx(st,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"暂无新订单"})]}):h.latestOrders.map(d=>e.jsx("div",{className:"px-4 py-3 hover:bg-gray-50 border-b border-gray-100 last:border-b-0",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-900 truncate",children:["#",d.pickupCode]}),e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${N(d.status)}`,children:y(d.status)})]}),e.jsxs("p",{className:"text-xs text-gray-600 mb-1",children:["顾客: ",d.groupName]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(mt,{className:"h-3 w-3"}),"€",d.total.toFixed(1)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ee,{className:"h-3 w-3"}),x(d.createdAt)]})]})]})})},d.id))}),e.jsx("div",{className:"px-4 py-3 border-t border-gray-200 bg-gray-50 rounded-b-md",children:e.jsx("button",{onClick:()=>{r("/admin/orders"),i(!1)},className:"w-full text-center text-sm text-orange-600 hover:text-orange-800 font-medium",children:"查看所有订单"})})]})})]}),e.jsxs("div",{className:"group relative",children:[e.jsxs("button",{className:"flex items-center gap-2 rounded-full hover:bg-gray-100 p-1",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-orange-100 text-orange-600",children:e.jsx(ut,{className:"h-5 w-5"})}),e.jsx("span",{className:"hidden text-sm font-medium text-gray-700 md:block",children:(a==null?void 0:a.username)||"管理员"})]}),e.jsx("div",{className:"absolute right-0 mt-2 hidden w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 group-hover:block",children:e.jsxs("button",{onClick:o,className:"flex w-full items-center gap-2 px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100",children:[e.jsx(Fa,{className:"h-4 w-4"}),"退出登录"]})})]})]})]})})},Or=({isOpen:t,onClose:a})=>e.jsxs(e.Fragment,{children:[t&&e.jsx("div",{className:"fixed inset-0 z-20 bg-black bg-opacity-50 transition-opacity md:hidden",onClick:a}),e.jsxs("aside",{className:`fixed inset-y-0 left-0 z-30 w-64 transform bg-white shadow-lg transition-transform duration-300 ease-in-out md:relative md:translate-x-0 ${t?"translate-x-0":"-translate-x-full"}`,children:[e.jsxs("div",{className:"flex h-16 items-center justify-between border-b border-gray-200 px-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ue,{className:"h-6 w-6 text-orange-500"}),e.jsx("span",{className:"ml-2 text-lg font-bold text-gray-900",children:"餐饮管理系统"})]}),e.jsx("button",{onClick:a,className:"rounded-full p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-500 md:hidden",children:e.jsx(se,{className:"h-6 w-6"})})]}),e.jsx("nav",{className:"mt-5 px-4",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:e.jsxs(le,{to:"/admin/dashboard",className:({isActive:s})=>`flex items-center rounded-lg px-4 py-3 text-sm font-medium ${s?"bg-orange-50 text-orange-700":"text-gray-700 hover:bg-gray-100"}`,children:[e.jsx(La,{className:"mr-3 h-5 w-5"}),"控制面板"]})}),e.jsx("li",{children:e.jsxs(le,{to:"/admin/orders",className:({isActive:s})=>`flex items-center rounded-lg px-4 py-3 text-sm font-medium ${s?"bg-orange-50 text-orange-700":"text-gray-700 hover:bg-gray-100"}`,children:[e.jsx(Ia,{className:"mr-3 h-5 w-5"}),"订单管理"]})}),e.jsx("li",{children:e.jsxs(le,{to:"/admin/menu",className:({isActive:s})=>`flex items-center rounded-lg px-4 py-3 text-sm font-medium ${s?"bg-orange-50 text-orange-700":"text-gray-700 hover:bg-gray-100"}`,children:[e.jsx(Ka,{className:"mr-3 h-5 w-5"}),"菜品管理"]})}),e.jsx("li",{children:e.jsxs(le,{to:"/admin/preparation",className:({isActive:s})=>`flex items-center rounded-lg px-4 py-3 text-sm font-medium ${s?"bg-orange-50 text-orange-700":"text-gray-700 hover:bg-gray-100"}`,children:[e.jsx(ct,{className:"mr-3 h-5 w-5"}),"备餐统计"]})}),e.jsx("li",{children:e.jsxs(le,{to:"/admin/statistics",className:({isActive:s})=>`flex items-center rounded-lg px-4 py-3 text-sm font-medium ${s?"bg-orange-50 text-orange-700":"text-gray-700 hover:bg-gray-100"}`,children:[e.jsx(Da,{className:"mr-3 h-5 w-5"}),"数据统计"]})}),e.jsx("li",{children:e.jsxs(le,{to:"/admin/settings",className:({isActive:s})=>`flex items-center rounded-lg px-4 py-3 text-sm font-medium ${s?"bg-orange-50 text-orange-700":"text-gray-700 hover:bg-gray-100"}`,children:[e.jsx(Va,{className:"mr-3 h-5 w-5"}),"系统设置"]})})]})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4",children:e.jsxs("div",{className:"rounded-lg bg-orange-50 p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-orange-800",children:"当前版本"}),e.jsx("p",{className:"mt-1 text-xs text-orange-600",children:"餐饮管理系统 v1.0.0"})]})})]})]}),Dr=()=>{const t=Oe(),{orders:a}=fe(),s=new Date;s.setHours(0,0,0,0);const r=a.filter(x=>(x.createdAt instanceof Date?x.createdAt:new Date(x.createdAt))>=s),n=r.reduce((x,y)=>x+y.total,0),i=a.filter(x=>x.status==="pending"),h=Array.from(new Set(r.map(x=>x.groupName))).length;return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"仪表盘"}),e.jsx("div",{className:"text-sm text-gray-500",children:new Date().toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric",weekday:"long"})})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"今日订单数"}),e.jsx("p",{className:"mt-1 text-2xl font-semibold text-gray-900",children:r.length})]}),e.jsx("div",{className:"rounded-full bg-green-100 p-3 text-green-600",children:e.jsx(ue,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"mt-4 flex items-center text-xs font-medium text-green-600",children:[e.jsx(rt,{className:"mr-1 h-3 w-3"}),e.jsx("span",{children:"较昨日增长 23%"})]})]}),e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"今日营业额"}),e.jsxs("p",{className:"mt-1 text-2xl font-semibold text-gray-900",children:["€",n.toFixed(1)]})]}),e.jsx("div",{className:"rounded-full bg-blue-100 p-3 text-blue-600",children:e.jsx(mt,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"mt-4 flex items-center text-xs font-medium text-blue-600",children:[e.jsx(rt,{className:"mr-1 h-3 w-3"}),e.jsx("span",{children:"较昨日增长 15%"})]})]}),e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"待处理订单"}),e.jsx("p",{className:"mt-1 text-2xl font-semibold text-gray-900",children:i.length})]}),e.jsx("div",{className:"rounded-full bg-amber-100 p-3 text-amber-600",children:e.jsx(ee,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"mt-4 flex items-center text-xs font-medium text-amber-600",children:[e.jsx(ee,{className:"mr-1 h-3 w-3"}),e.jsx("span",{children:"平均处理时间 12 分钟"})]})]}),e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"今日顾客"}),e.jsx("p",{className:"mt-1 text-2xl font-semibold text-gray-900",children:h})]}),e.jsx("div",{className:"rounded-full bg-purple-100 p-3 text-purple-600",children:e.jsx(nt,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"mt-4 flex items-center text-xs font-medium text-purple-600",children:[e.jsx(nt,{className:"mr-1 h-3 w-3"}),e.jsx("span",{children:"今日不同客户数量"})]})]})]}),e.jsxs("div",{className:"mb-6 overflow-hidden rounded-lg bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsx("h2",{className:"font-semibold text-gray-800",children:"最近订单"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"订单编号"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"取餐码"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"时间"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"金额"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"状态"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500",children:"操作"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-gray-500",children:"暂无订单数据"})}):a.slice(-5).map(x=>e.jsxs("tr",{children:[e.jsxs("td",{className:"whitespace-nowrap px-6 py-4 text-sm font-medium text-gray-900",children:[x.id.substring(0,8),"..."]}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500",children:x.pickupCode}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500",children:(x.createdAt instanceof Date?x.createdAt:new Date(x.createdAt)).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})}),e.jsxs("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500",children:["€",x.total.toFixed(1)]}),e.jsxs("td",{className:"whitespace-nowrap px-6 py-4",children:[x.status==="pending"&&e.jsx("span",{className:"inline-flex rounded-full bg-yellow-100 px-2 text-xs font-semibold leading-5 text-yellow-800",children:"待处理"}),x.status==="preparing"&&e.jsx("span",{className:"inline-flex rounded-full bg-blue-100 px-2 text-xs font-semibold leading-5 text-blue-800",children:"制作中"}),x.status==="ready"&&e.jsx("span",{className:"inline-flex rounded-full bg-green-100 px-2 text-xs font-semibold leading-5 text-green-800",children:"可取餐"}),x.status==="completed"&&e.jsx("span",{className:"inline-flex rounded-full bg-gray-100 px-2 text-xs font-semibold leading-5 text-gray-800",children:"已完成"})]}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-right text-sm font-medium",children:e.jsx("button",{onClick:()=>t("/admin/orders"),className:"text-orange-600 hover:text-orange-900",children:"查看详情"})})]},x.id))})]})}),e.jsx("div",{className:"border-t border-gray-200 bg-gray-50 px-6 py-3 text-right",children:e.jsxs("button",{onClick:()=>t("/admin/orders"),className:"flex items-center justify-end text-sm font-medium text-orange-600 hover:text-orange-800",children:["查看所有订单",e.jsx(Oa,{className:"ml-1 h-4 w-4"})]})})]})]})},Er=()=>{const{orders:t,updateOrderStatus:a,deleteOrder:s}=fe(),[r,n]=m.useState(""),[i,o]=m.useState("all"),[h,x]=m.useState(!1),[y,N]=m.useState(new Date().toISOString().split("T")[0]),d=t.filter(l=>{const c=l.id.toLowerCase().includes(r.toLowerCase())||l.pickupCode.toLowerCase().includes(r.toLowerCase())||l.groupName&&l.groupName.toLowerCase().includes(r.toLowerCase()),v=i==="all"||l.status===i,D=(l.createdAt instanceof Date?l.createdAt:new Date(l.createdAt)).toISOString().split("T")[0]===y;return c&&v&&D});console.log("OrderManagement 渲染 - 当前订单数据:",t.length,t),console.log("选中日期:",y),console.log("过滤后订单数据:",d.length,d),console.log("搜索条件:",{searchQuery:r,filterStatus:i});const j=new Date().toISOString().split("T")[0],S=t.filter(l=>(l.createdAt instanceof Date?l.createdAt:new Date(l.createdAt)).toISOString().split("T")[0]===j);console.log("今天的订单:",S.length,S);const w=async(l,c)=>{try{await a(l,c)}catch(v){console.error("更新订单状态失败:",v),alert("更新订单状态失败，请重试")}},b=async(l,c)=>{if(confirm(`确定要删除订单 ${c} 吗？
此操作不可恢复！`))try{await s(l)}catch(v){console.error("删除订单失败:",v),alert("删除订单失败，请重试")}},p=l=>{switch(l){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"preparing":return"bg-blue-100 text-blue-800 border-blue-200";case"ready":return"bg-green-100 text-green-800 border-green-200";case"completed":return"bg-gray-100 text-gray-800 border-gray-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},g=l=>{switch(l){case"pending":return"待处理";case"preparing":return"制作中";case"ready":return"可取餐";case"completed":return"已完成";case"cancelled":return"已取消";default:return"未知状态"}},f=l=>{switch(l){case"pending":return{action:"preparing",text:"开始制作",icon:ee,color:"bg-blue-50 text-blue-700 hover:bg-blue-100 border-blue-200"};case"preparing":return{action:"ready",text:"制作完成",icon:Gt,color:"bg-green-50 text-green-700 hover:bg-green-100 border-green-200"};case"ready":return{action:"completed",text:"客户取餐",icon:at,color:"bg-gray-50 text-gray-700 hover:bg-gray-100 border-gray-200"};default:return null}},u=l=>{let c=l.menuItem.price;return l.special&&l.menuItem.customOptions,c*l.quantity};return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6 flex flex-col justify-between gap-4 sm:flex-row sm:items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"订单管理"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"管理和跟踪所有订单状态"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Qt,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"date",value:y,onChange:l=>N(l.target.value),className:"rounded-md border border-gray-300 px-3 py-2 pl-10 text-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})]}),e.jsxs("button",{onClick:()=>x(!h),className:"flex items-center gap-1 rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",children:[e.jsx($a,{className:"h-4 w-4"}),"筛选",e.jsx(dt,{className:"h-4 w-4"})]})]})]}),h&&e.jsxs("div",{className:"mb-6 rounded-lg bg-white p-4 shadow-sm border",children:[e.jsx("div",{className:"mb-4 flex items-center",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx(Ja,{className:"h-4 w-4 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"搜索订单号、取餐码或群昵称...",value:r,onChange:l=>n(l.target.value),className:"block w-full rounded-md border border-gray-300 py-2 pl-10 pr-3 text-sm placeholder-gray-400 focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})]})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>o("all"),className:`rounded-full px-3 py-1 text-sm border ${i==="all"?"bg-orange-500 text-white border-orange-500":"bg-white text-gray-700 hover:bg-gray-50 border-gray-300"}`,children:"全部订单"}),e.jsx("button",{onClick:()=>o("pending"),className:`rounded-full px-3 py-1 text-sm border ${i==="pending"?"bg-orange-500 text-white border-orange-500":"bg-white text-gray-700 hover:bg-gray-50 border-gray-300"}`,children:"待处理"}),e.jsx("button",{onClick:()=>o("preparing"),className:`rounded-full px-3 py-1 text-sm border ${i==="preparing"?"bg-orange-500 text-white border-orange-500":"bg-white text-gray-700 hover:bg-gray-50 border-gray-300"}`,children:"制作中"}),e.jsx("button",{onClick:()=>o("ready"),className:`rounded-full px-3 py-1 text-sm border ${i==="ready"?"bg-orange-500 text-white border-orange-500":"bg-white text-gray-700 hover:bg-gray-50 border-gray-300"}`,children:"可取餐"}),e.jsx("button",{onClick:()=>o("completed"),className:`rounded-full px-3 py-1 text-sm border ${i==="completed"?"bg-orange-500 text-white border-orange-500":"bg-white text-gray-700 hover:bg-gray-50 border-gray-300"}`,children:"已完成"})]})]}),d.length===0?e.jsxs("div",{className:"rounded-lg bg-white p-12 text-center shadow-sm border",children:[e.jsx(at,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"暂无订单"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:y===new Date().toISOString().split("T")[0]?"今日还没有新订单":"选定日期没有订单"})]}):e.jsx("div",{className:"grid gap-4 lg:grid-cols-2 xl:grid-cols-3",children:d.map(l=>e.jsxs("div",{className:"rounded-lg bg-white p-6 shadow-sm border hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-orange-100 flex items-center justify-center",children:e.jsx(ut,{className:"h-5 w-5 text-orange-600"})})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:l.groupName||"未知用户"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["取餐码: ",e.jsx("span",{className:"font-mono font-semibold text-orange-600",children:l.pickupCode})]})]})]}),e.jsx("span",{className:`inline-flex rounded-full px-2 py-1 text-xs font-semibold border ${p(l.status)}`,children:g(l.status)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 text-sm",children:[e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(ee,{className:"h-4 w-4 mr-1"}),(l.createdAt instanceof Date?l.createdAt:new Date(l.createdAt)).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})]}),e.jsxs("div",{className:"flex items-center text-gray-900 font-semibold",children:[e.jsx(Aa,{className:"h-4 w-4 mr-1"}),"€",l.total.toFixed(1)]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"订单详情"}),e.jsx("div",{className:"space-y-2 max-h-24 overflow-y-auto",children:l.items.map((c,v)=>{const C=u(c);return e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"text-gray-900 font-medium",children:c.menuItem.name}),c.special&&e.jsx("div",{className:"text-gray-500 text-xs truncate mt-1",children:c.special})]}),e.jsxs("div",{className:"text-right whitespace-nowrap",children:[e.jsxs("div",{children:[c.quantity,"x"]}),e.jsxs("div",{className:"text-gray-900 font-medium",children:["€",(C/c.quantity).toFixed(1)]})]})]},v)})}),e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-100",children:e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:["总计 ",l.items.reduce((c,v)=>c+v.quantity,0)," 件商品"]}),e.jsxs("span",{className:"font-semibold text-gray-900",children:["€",l.total.toFixed(1)]})]})})]}),l.notes&&e.jsx("div",{className:"mb-4 p-2 bg-gray-50 rounded-md",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(qa,{className:"h-4 w-4 text-gray-400 mr-2 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-gray-600",children:l.notes})]})}),e.jsx("div",{className:"flex space-x-2",children:(()=>{const c=f(l.status);return e.jsxs(e.Fragment,{children:[c&&e.jsxs("button",{onClick:()=>w(l.id,c.action),className:`flex-1 flex items-center justify-center rounded-md px-3 py-2 text-xs font-medium border transition-colors ${c.color}`,children:[e.jsx(c.icon,{className:"mr-1 h-3 w-3"}),c.text]}),(l.status==="pending"||l.status==="preparing")&&e.jsx("button",{onClick:()=>w(l.id,"cancelled"),className:"flex-shrink-0 flex items-center justify-center rounded-md px-3 py-2 text-xs font-medium bg-red-50 text-red-700 hover:bg-red-100 border border-red-200 transition-colors",title:"取消订单",children:e.jsx(se,{className:"h-3 w-3"})}),e.jsx("button",{onClick:()=>b(l.id,`${l.pickupCode} (${l.groupName})`),className:"flex-shrink-0 flex items-center justify-center rounded-md px-3 py-2 text-xs font-medium bg-gray-50 text-gray-500 hover:bg-red-50 hover:text-red-700 border border-gray-200 hover:border-red-200 transition-colors",title:"删除订单",children:e.jsx(es,{className:"h-3 w-3"})})]})})()})]},l.id))})]})},Mt={id:"",name:"",description:"",price:0,imageUrl:"",category:"",available:!0},Ir=({item:t,onSave:a,onCancel:s})=>{const{categories:r}=De(),[n,i]=m.useState(t||{...Mt}),[o,h]=m.useState([]);m.useEffect(()=>{t?(i(t),t.customOptions&&t.customOptions.length>0?h(t.customOptions):h([])):(i({...Mt}),h([]))},[t]);const x=g=>{const{name:f,value:u}=g.target;i(l=>({...l,[f]:f==="price"?u===""?0:parseFloat(u)||0:u}))},y=g=>{const{name:f,checked:u}=g.target;i(l=>({...l,[f]:u}))},N=()=>{h(g=>[...g||[],{type:`option_${Date.now()}`,title:"",required:!1,options:[{id:`option_${Date.now()}`,name:"",isDefault:!0}]}])},d=g=>{h(f=>{const u=[...f||[]];return u.splice(g,1),u})},j=(g,f,u)=>{h(l=>{const c=[...l||[]];return c[g]={...c[g],[f]:u},c})},S=g=>{h(f=>{const u=[...f||[]];return u[g]={...u[g],options:[...u[g].options||[],{id:`option_${Date.now()}`,name:"",isDefault:!1}]},u})},w=(g,f)=>{h(u=>{const l=[...u||[]],c=[...l[g].options];return c.splice(f,1),l[g]={...l[g],options:c},l})},b=(g,f,u,l)=>{h(c=>{const v=[...c||[]],C=[...v[g].options];return C[f]={...C[f],[u]:u==="price"?l===""?void 0:parseFloat(l)||0:l},v[g]={...v[g],options:C},v})},p=g=>{g.preventDefault();const f={...n,id:n.id||`item_${Date.now()}`,customOptions:o||[]};a(f)};return e.jsxs("form",{onSubmit:p,className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:t?"编辑菜品":"添加新菜品"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4 md:col-span-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["菜品名称 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"name",value:n.name,onChange:x,required:!0,className:"w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"描述"}),e.jsx("textarea",{name:"description",value:n.description,onChange:x,rows:3,className:"w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["价格 (€) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",name:"price",value:n.price!==void 0?n.price:"",onChange:x,step:"0.1",min:"0",required:!0,className:"w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["分类 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"category",value:n.category,onChange:x,required:!0,className:"w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"选择分类"}),r.map(g=>e.jsx("option",{value:g.id,children:g.name},g.id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["图片URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"imageUrl",value:n.imageUrl,onChange:x,required:!0,className:"w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",name:"available",checked:n.available,onChange:y,className:"h-4 w-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"可供应"})]})}),e.jsxs("div",{className:"md:col-span-2 border-t border-gray-200 pt-4 mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-800",children:"自定义选项"}),e.jsxs("button",{type:"button",onClick:N,className:"flex items-center space-x-1 rounded-md bg-orange-100 px-3 py-1 text-xs font-medium text-orange-600 hover:bg-orange-200",children:[e.jsx(Q,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:"添加选项组"})]})]}),o&&o.map((g,f)=>e.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 flex items-center space-x-3",children:[e.jsx("input",{type:"text",value:g.title,onChange:u=>j(f,"title",u.target.value),placeholder:"选项组名称（如温度、辣度等）",className:"flex-1 rounded-md border border-gray-300 px-3 py-2 text-sm shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"}),e.jsxs("select",{value:g.type==="checkbox"?"checkbox":"radio",onChange:u=>j(f,"type",u.target.value),className:"rounded-md border border-gray-300 px-3 py-2 text-sm shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500",children:[e.jsx("option",{value:"radio",children:"单选"}),e.jsx("option",{value:"checkbox",children:"多选"})]})]}),e.jsx("button",{type:"button",onClick:()=>d(f),className:"text-red-500 hover:text-red-700 ml-2",children:e.jsx(G,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx("input",{type:"checkbox",checked:!!g.required,onChange:u=>j(f,"required",u.target.checked),className:"h-4 w-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"必选"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"选项列表"}),e.jsxs("button",{type:"button",onClick:()=>S(f),className:"flex items-center space-x-1 rounded-md bg-gray-100 px-2 py-1 text-xs font-medium text-gray-600 hover:bg-gray-200",children:[e.jsx(Q,{className:"h-3 w-3"}),e.jsx("span",{children:"添加选项"})]})]}),g.options.map((u,l)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",value:u.name,onChange:c=>b(f,l,"name",c.target.value),placeholder:"选项名称",className:"w-full rounded-md border border-gray-300 px-3 py-1.5 text-sm shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})}),e.jsx("div",{className:"w-24",children:e.jsx("input",{type:"number",value:u.price!==void 0?u.price:"",onChange:c=>b(f,l,"price",c.target.value),step:"0.1",min:"0",placeholder:"额外费用",className:"w-full rounded-md border border-gray-300 px-3 py-1.5 text-sm shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!!u.isDefault,onChange:c=>b(f,l,"isDefault",c.target.checked),className:"h-4 w-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),e.jsx("label",{className:"text-xs text-gray-500",children:"默认"})]}),e.jsx("button",{type:"button",onClick:()=>w(f,l),className:"text-red-500 hover:text-red-700",children:e.jsx(G,{className:"h-3.5 w-3.5"})})]},l))]})]},f)),(!o||o.length===0)&&e.jsxs("div",{className:"text-center py-6 text-gray-500",children:[e.jsx("p",{className:"text-sm",children:"暂无自定义选项"}),e.jsx("p",{className:"text-xs",children:'点击"添加选项组"为菜品添加个性化选项（如辣度、温度、加料等）'})]})]})]}),e.jsxs("div",{className:"mt-8 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:s,className:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50",children:"取消"}),e.jsx("button",{type:"submit",className:"rounded-md bg-orange-500 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-orange-600",children:t?"更新":"添加"})]})]})},Mr=()=>{const{categories:t,addCategory:a,updateCategory:s,deleteCategory:r}=De(),[n,i]=m.useState(null),[o,h]=m.useState(!1),[x,y]=m.useState(""),N=()=>(Math.max(...t.map(l=>parseInt(l.id)||0),0)+1).toString(),d=()=>Math.max(...t.map(l=>l.order),0)+1,j=()=>{if(!x.trim())return;const u={id:N(),name:x.trim(),order:d()};a(u),y(""),h(!1)},S=u=>{i(u)},w=()=>{!n||!n.name.trim()||(s(n.id,{name:n.name.trim()}),i(null))},b=u=>{window.confirm(`确定要删除分类"${u.name}"吗？删除后该分类下的所有菜品将需要重新分类。`)&&r(u.id)},p=(u,l)=>{const c=[...t].sort((R,B)=>R.order-B.order),v=c.findIndex(R=>R.id===u);if(l==="up"&&v===0||l==="down"&&v===c.length-1)return;const C=l==="up"?v-1:v+1,E=c[v],D=c[C];s(E.id,{order:D.order}),s(D.id,{order:E.order})},g=()=>{i(null)},f=()=>{h(!1),y("")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"分类管理"}),!o&&e.jsxs("button",{onClick:()=>h(!0),className:"flex items-center space-x-1 rounded-md bg-orange-500 px-4 py-2 text-sm font-medium text-white hover:bg-orange-600",children:[e.jsx(Q,{className:"h-4 w-4"}),e.jsx("span",{children:"添加分类"})]})]}),o&&e.jsxs("div",{className:"rounded-lg bg-gray-50 p-4",children:[e.jsx("h3",{className:"mb-3 text-lg font-medium text-gray-800",children:"添加新分类"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"text",value:x,onChange:u=>y(u.target.value),placeholder:"请输入分类名称",className:"flex-1 rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500",autoFocus:!0}),e.jsx("button",{onClick:j,disabled:!x.trim(),className:"rounded-md bg-orange-500 px-4 py-2 text-sm font-medium text-white hover:bg-orange-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"保存"}),e.jsx("button",{onClick:f,className:"rounded-md bg-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-400",children:"取消"})]})]}),e.jsx("div",{className:"space-y-3",children:t.sort((u,l)=>u.order-l.order).map((u,l)=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-white p-4 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("button",{onClick:()=>p(u.id,"up"),disabled:l===0,className:"rounded p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-600 disabled:cursor-not-allowed disabled:opacity-30",children:e.jsx(Ba,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>p(u.id,"down"),disabled:l===t.length-1,className:"rounded p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-600 disabled:cursor-not-allowed disabled:opacity-30",children:e.jsx(za,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex-1",children:(n==null?void 0:n.id)===u.id?e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"text",value:n.name,onChange:c=>i({...n,name:c.target.value}),className:"flex-1 rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500",autoFocus:!0}),e.jsx("button",{onClick:w,disabled:!n.name.trim(),className:"rounded-md bg-orange-500 px-3 py-1 text-sm font-medium text-white hover:bg-orange-600 disabled:bg-gray-300",children:"保存"}),e.jsx("button",{onClick:g,className:"rounded-md bg-gray-300 px-3 py-1 text-sm font-medium text-gray-700 hover:bg-gray-400",children:"取消"})]}):e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800",children:u.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["排序: ",u.order]})]})})]}),(n==null?void 0:n.id)!==u.id&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>S(u),className:"rounded-md bg-gray-100 p-2 text-gray-600 hover:bg-gray-200",children:e.jsx(Xt,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>b(u),className:"rounded-md bg-red-50 p-2 text-red-500 hover:bg-red-100",children:e.jsx(G,{className:"h-4 w-4"})})]})]},u.id))}),t.length===0&&e.jsx("div",{className:"text-center text-gray-500 py-8",children:"暂无分类，请添加分类"})]})},Ar=()=>{const{menuItems:t,categories:a,addMenuItem:s,updateMenuItem:r,deleteMenuItem:n}=De(),[i,o]=m.useState("menu"),[h,x]=m.useState(!1),[y,N]=m.useState("all"),[d,j]=m.useState(void 0),[S,w]=m.useState(""),b=t.filter(c=>!(y!=="all"&&c.category!==y||S&&!c.name.toLowerCase().includes(S.toLowerCase()))),p=c=>{c.id&&t.some(v=>v.id===c.id)?r(c.id,c):s(c),x(!1),j(void 0)},g=c=>{j(c),x(!0)},f=()=>{j(void 0),x(!0)},u=()=>{x(!1),j(void 0)},l=()=>b.length===0?e.jsx("div",{className:"py-12 text-center text-gray-500",children:S?"没有找到匹配的菜品":"此分类暂无菜品"}):e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:b.map(c=>{var v;return e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white shadow-sm transition-all hover:shadow",children:[e.jsxs("div",{className:"relative h-48 overflow-hidden",children:[e.jsx("img",{src:c.imageUrl,alt:c.name,className:"h-full w-full object-cover"}),e.jsx("div",{className:"absolute top-2 right-2 flex gap-1",children:e.jsx("span",{className:`rounded-full px-2 py-0.5 text-xs font-medium ${c.available?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:c.available?"已上架":"已下架"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-1 flex justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800",children:c.name}),e.jsxs("div",{className:"text-orange-500 font-semibold",children:["€",c.price,c.customOptions&&c.customOptions.length>0&&e.jsx("span",{className:"text-xs",children:"起"})]})]}),e.jsx("p",{className:"mb-3 text-sm text-gray-500 line-clamp-2",children:c.description}),c.customOptions&&c.customOptions.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"自定义选项："}),e.jsx("div",{className:"mt-1",children:c.customOptions.map((C,E)=>e.jsxs("div",{className:"mb-1",children:[e.jsxs("span",{className:"text-xs font-medium text-gray-600",children:[C.title,"："]}),e.jsx("div",{className:"mt-0.5 flex flex-wrap gap-1",children:C.options.map((D,R)=>e.jsxs("span",{className:"rounded-full bg-blue-50 px-2 py-0.5 text-xs text-blue-600",children:[D.name,D.price?` +€${D.price.toFixed(1)}`:"",D.isDefault&&" (默认)"]},R))})]},E))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-500",children:((v=a.find(C=>C.id===c.category))==null?void 0:v.name)||"未分类"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>g(c),className:"rounded-md bg-gray-100 p-1.5 text-gray-600 hover:bg-gray-200",children:e.jsx(Xt,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>{window.confirm(`确定要删除"${c.name}"吗？`)&&n(c.id)},className:"rounded-md bg-red-50 p-1.5 text-red-500 hover:bg-red-100",children:e.jsx(G,{className:"h-4 w-4"})})]})]})]})]},c.id)})});return e.jsxs("div",{children:[e.jsx("div",{className:"mb-6 flex items-center justify-between",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"菜单管理"})}),e.jsx("div",{className:"mb-6 border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>o("menu"),className:`border-b-2 px-1 py-4 text-sm font-medium transition-colors ${i==="menu"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ra,{className:"h-4 w-4"}),e.jsx("span",{children:"菜品管理"})]})}),e.jsx("button",{onClick:()=>o("category"),className:`border-b-2 px-1 py-4 text-sm font-medium transition-colors ${i==="category"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ha,{className:"h-4 w-4"}),e.jsx("span",{children:"分类管理"})]})})]})}),i==="menu"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-6 flex justify-end",children:e.jsxs("button",{onClick:f,className:"flex items-center space-x-1 rounded-md bg-orange-500 px-4 py-2 text-sm font-medium text-white hover:bg-orange-600",children:[e.jsx(Q,{className:"h-4 w-4"}),e.jsx("span",{children:"添加菜品"})]})}),e.jsxs("div",{className:"mb-6 flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>N("all"),className:`rounded-full px-4 py-1.5 text-sm ${y==="all"?"bg-orange-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"全部菜品"}),a.map(c=>e.jsx("button",{onClick:()=>N(c.id),className:`rounded-full px-4 py-1.5 text-sm ${y===c.id?"bg-orange-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:c.name},c.id))]}),e.jsx("div",{className:"w-full md:w-64",children:e.jsx("input",{type:"text",value:S,onChange:c=>w(c.target.value),placeholder:"搜索菜品...",className:"w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})})]}),h?e.jsx(Ir,{item:d,onSave:p,onCancel:u}):l()]}),i==="category"&&e.jsx(Mr,{})]})},$r=({initialData:t=Se,onSave:a})=>{const[s,r]=m.useState(t),[n,i]=m.useState(""),[o,h]=m.useState(""),[x,y]=m.useState(()=>{if(s.specialDeadline){const k=s.specialDeadline.match(/^(.*?)(\d+\.\d+)/);return k?k[1]:"甜品截至"}return"甜品截至"}),[N,d]=m.useState(s),[j,S]=m.useState(0),w=m.useRef(s),b=()=>{d({...s}),S(k=>k+1)};m.useEffect(()=>{JSON.stringify(w.current)!==JSON.stringify(s)&&(w.current=s,b())},[s]);const p=k=>{r(k),Promise.resolve().then(()=>{b()})};m.useEffect(()=>{b()},[]);const g=k=>{k.preventDefault(),a(s)},f=(k,O)=>{const L={...s,[O]:k.target.value};p(L)},u=k=>{p({...s,isEnabled:k.target.checked})},l=k=>{try{const[O,L,$]=k.split("-").map(T=>parseInt(T)),P=`${L}.${$}`,A=new Date(O,L-1,$),F=["周日","周一","周二","周三","周四","周五","周六"][A.getDay()];p({...s,orderDate:P,orderWeekday:F}),c(O,L,$),C(O,L,$),b()}catch(O){console.error("日期解析错误",O)}},c=(k,O,L)=>{try{const $=`${O}.${L}`,P=new Date(k,O-1,L),I=["周日","周一","周二","周三","周四","周五","周六"][P.getDay()];let F="12:00";if(s.orderDeadline){const T=s.orderDeadline.match(/\d{1,2}:\d{2}$/);T&&(F=T[0])}p(T=>({...T,orderDeadline:`${$}（${I}）${F}`}))}catch($){console.error("更新截单日期错误",$)}},v=(k,O,L)=>{try{let $="";if(O)$=O;else if(s.specialDeadline){const I=s.specialDeadline.match(/(\d+\.\d+)/);$=I?I[0]:""}let P="";if(L)P=L;else if(s.specialDeadline){const I=s.specialDeadline.match(/(\d{1,2}:\d{2})/);P=I?I[0]:""}if(!$){const I=new Date;I.setDate(I.getDate()-1);const F=I.getMonth()+1,T=I.getDate();$=`${F}.${T}`}P||(P="22:00");const A=`${k}${$}晚${P}`;p(I=>({...I,specialDeadline:A}))}catch($){console.error("更新特殊截单时间错误",$)}},C=(k,O,L)=>{try{const $=new Date(k,O-1,L);$.setDate($.getDate()-1);const P=$.getMonth()+1,A=$.getDate(),I=`${P}.${A}`;v(x,I)}catch($){console.error("更新特殊截单日期错误",$)}},E=k=>{try{const O=k.replace(/:/g,":");p({...s,pickupTime:O})}catch(O){console.error("时间格式化错误",O)}},D=k=>{try{if(k.includes(":"))return k;if(k.length>=4){const O=k.slice(0,2),L=k.slice(2,4);return`${O}:${L}`}}catch(O){console.error("时间格式化错误",O)}return"18:00"},R=()=>{n.trim()&&(p({...s,paymentMethods:[...s.paymentMethods,n.trim()]}),i(""))},B=k=>{const O=[...s.paymentMethods];O.splice(k,1),p({...s,paymentMethods:O})},ae=()=>{o.trim()&&(p({...s,tips:[...s.tips,o.trim()]}),h(""))},Me=k=>{const O=[...s.tips];O.splice(k,1),p({...s,tips:O})},V=()=>{try{if(s.orderDate){const[P,A]=s.orderDate.split(".");if(P&&A){const I=new Date().getFullYear(),F=String(parseInt(P)).padStart(2,"0"),T=String(parseInt(A)).padStart(2,"0");return`${I}-${F}-${T}`}}}catch(P){console.error("日期格式化错误",P)}const k=new Date,O=k.getFullYear(),L=String(k.getMonth()+1).padStart(2,"0"),$=String(k.getDate()).padStart(2,"0");return`${O}-${L}-${$}`},re=k=>{try{const O=s.orderDeadline.replace(/\d{1,2}:\d{2}$/,"");p(L=>({...L,orderDeadline:`${O}${k}`}))}catch(O){console.error("更新截单时间错误",O)}},ye=k=>{try{v(x,void 0,k),b()}catch(O){console.error("更新特殊截单时间错误",O)}},Ae=k=>{try{const O=k.match(/(\d{1,2}):(\d{2})$/);if(O)return`${O[1].padStart(2,"0")}:${O[2]}`}catch(O){console.error("提取时间错误",O)}return"12:00"},Ve=k=>{try{if(k){const O=k.match(/(\d{1,2}):(\d{2})/);if(O)return`${O[1].padStart(2,"0")}:${O[2]}`}}catch(O){console.error("提取特殊截单时间错误",O)}return"22:00"},We=k=>{const[,O,L]=k.target.value.split("-").map(P=>parseInt(P)),$=`${O}.${L}`;v(x,$),b()};return e.jsxs("form",{onSubmit:g,className:"space-y-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"enable-announcement",checked:s.isEnabled,onChange:u,className:"h-5 w-5 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),e.jsx("label",{htmlFor:"enable-announcement",className:"ml-2 block text-base font-medium text-gray-800",children:"启用公告"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:b,className:"rounded-md bg-blue-500 px-4 py-2 text-sm font-medium text-white hover:bg-blue-600 shadow-sm",children:"刷新预览"}),e.jsx("button",{type:"submit",className:"rounded-md bg-orange-500 px-4 py-2 text-sm font-medium text-white hover:bg-orange-600 shadow-sm",children:"保存公告设置"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4 border-b pb-2",children:"公告标题和描述"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"公告标题"}),e.jsx("input",{type:"text",value:s.title||"",onChange:k=>f(k,"title"),placeholder:"例如: 📢 本周周五订餐公告",className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"公告描述"}),e.jsx("input",{type:"text",value:s.description||"",onChange:k=>f(k,"description"),placeholder:"例如: 请查看以下重要信息，以便顺利完成订餐",className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4 border-b pb-2",children:"订餐基本信息"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"订餐日期"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{type:"date",value:V(),onChange:k=>l(k.target.value),className:"block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"取餐时间"}),e.jsx("input",{type:"time",value:D(s.pickupTime),onChange:k=>E(k.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-md p-2 border border-gray-200",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"取餐时间预览"}),e.jsxs("div",{className:"mt-1 text-sm font-medium",children:[s.orderDate,"（",s.orderWeekday,"）",s.pickupTime]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"取餐地点"}),e.jsx("input",{type:"text",value:s.pickupLocation,onChange:k=>f(k,"pickupLocation"),placeholder:"例如: 蓝塔楼下",className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"截单时间"}),e.jsxs("div",{className:"mt-1 space-y-2",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"截单日期"}),e.jsx("input",{type:"date",value:V(),onChange:k=>{const[O,L,$]=k.target.value.split("-").map(P=>parseInt(P));c(O,L,$)},className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-sm shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"截单时间"}),e.jsx("input",{type:"time",value:Ae(s.orderDeadline),onChange:k=>re(k.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-sm shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-md p-2 border border-gray-200",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"预览"}),e.jsx("div",{className:"mt-1 text-sm font-medium",children:s.orderDeadline})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"特殊截单时间 (可选)"}),e.jsxs("div",{className:"mt-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("input",{type:"checkbox",id:"enable-special-deadline",checked:!!s.specialDeadline,onChange:k=>{if(k.target.checked){const O=V(),[L,$,P]=O.split("-").map(A=>parseInt(A));C(L,$,P)}else p(O=>({...O,specialDeadline:void 0}))},className:"h-4 w-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),e.jsx("label",{htmlFor:"enable-special-deadline",className:"ml-2 text-xs text-gray-600",children:"启用特殊截单时间（例如：甜品提前一天截单）"})]}),s.specialDeadline&&e.jsxs("div",{className:"pl-6 space-y-2",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("label",{className:"text-xs text-gray-500 w-24",children:"特殊说明："}),e.jsx("input",{type:"text",value:x,onChange:k=>{y(k.target.value),v(k.target.value),b()},placeholder:"例如：甜品截至",className:"flex-1 rounded-md border border-gray-300 px-3 py-2 text-sm shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"特殊截单日期"}),e.jsx("input",{type:"date",value:(()=>{try{if(s.specialDeadline){const O=s.specialDeadline.match(/(\d+)\.(\d+)/);if(O){const L=parseInt(O[1]),$=parseInt(O[2]);return`${new Date().getFullYear()}-${String(L).padStart(2,"0")}-${String($).padStart(2,"0")}`}}}catch{}const k=new Date;return k.setDate(k.getDate()-1),k.toISOString().split("T")[0]})(),onChange:We,className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-sm shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"特殊截单时间"}),e.jsx("input",{type:"time",value:Ve(s.specialDeadline),onChange:k=>ye(k.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-sm shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-md p-2 border border-gray-200",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"预览"}),e.jsx("div",{className:"mt-1 text-sm font-medium text-orange-500",children:N.specialDeadline||""})]})]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4 border-b pb-2",children:"活动提醒"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"活动提醒文本 (可选)"}),e.jsx("textarea",{value:s.promotionText||"",onChange:k=>f(k,"promotionText"),placeholder:"例如: 本周特惠: 三份餐点八折优惠！单点饮料第二杯半价！",rows:2,className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"设置活动提醒文本将在公告顶部显示一个醒目的黄色提示栏。如不需要，请留空。"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4 border-b pb-2",children:"支付方式"}),e.jsxs("div",{className:"space-y-2",children:[s.paymentMethods.map((k,O)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"text",value:k,onChange:L=>{const $=[...s.paymentMethods];$[O]=L.target.value,p({...s,paymentMethods:$})},className:"block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"}),e.jsx("button",{type:"button",onClick:()=>B(O),className:"ml-2 text-red-500 hover:text-red-700",children:e.jsx(G,{className:"h-4 w-4"})})]},O)),e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx("input",{type:"text",value:n,onChange:k=>i(k.target.value),placeholder:"添加新支付方式",className:"block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"}),e.jsx("button",{type:"button",onClick:R,className:"ml-2 rounded-md bg-orange-500 p-2 text-white hover:bg-orange-600",children:e.jsx(Q,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4 border-b pb-2",children:"温馨提示"}),e.jsxs("div",{className:"space-y-2",children:[s.tips.map((k,O)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("textarea",{value:k,onChange:L=>{const $=[...s.tips];$[O]=L.target.value,p({...s,tips:$})},rows:2,className:"block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"}),e.jsx("button",{type:"button",onClick:()=>Me(O),className:"ml-2 text-red-500 hover:text-red-700",children:e.jsx(G,{className:"h-4 w-4"})})]},O)),e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx("textarea",{value:o,onChange:k=>h(k.target.value),placeholder:"添加新提示",rows:2,className:"block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"}),e.jsx("button",{type:"button",onClick:ae,className:"ml-2 rounded-md bg-orange-500 p-2 text-white hover:bg-orange-600",children:e.jsx(Q,{className:"h-4 w-4"})})]})]})]})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sticky top-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"公告预览"}),e.jsx("button",{type:"button",onClick:b,className:"text-sm text-blue-500 hover:text-blue-700",children:"刷新预览"})]}),e.jsxs("div",{className:"rounded-lg shadow-lg overflow-hidden border border-gray-200 bg-white",children:[e.jsxs("div",{className:"p-4 pb-2 bg-gradient-to-r from-blue-500 to-blue-600 rounded-t-lg",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:N.title||`📢 本周${N.orderWeekday}订餐公告`}),e.jsx("p",{className:"text-blue-100 text-sm",children:N.description||"请查看以下重要信息，以便顺利完成订餐"})]}),e.jsxs("div",{className:"p-4 pt-3",children:[N.promotionText&&e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-2 mb-3 rounded-r-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(xt,{className:"h-4 w-4 text-yellow-500 mr-1.5 flex-shrink-0"}),e.jsx("span",{className:"font-medium text-yellow-800 text-sm",children:N.promotionText})]})}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 mb-3 border border-blue-100",children:[e.jsx("h4",{className:"font-semibold text-blue-700 mb-1.5 text-sm",children:"基本信息"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"w-20 text-xs text-gray-600 mt-0.5",children:"取餐时间："}),e.jsxs("span",{className:"font-medium text-gray-900 text-sm",children:[N.orderDate,"（",N.orderWeekday,"）",N.pickupTime]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"w-20 text-xs text-gray-600 mt-0.5",children:"截单时间："}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium text-gray-900 text-sm",children:N.orderDeadline}),N.specialDeadline&&e.jsx("span",{className:"text-orange-500 font-medium text-xs",children:N.specialDeadline})]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"w-20 text-xs text-gray-600 mt-0.5",children:"取餐地点："}),e.jsx("span",{className:"font-medium text-gray-900 text-sm",children:N.pickupLocation})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"w-20 text-xs text-gray-600 mt-0.5",children:"支付方式："}),e.jsx("span",{className:"font-medium text-gray-900 text-sm",children:N.paymentMethods.join(" / ")})]})]})]}),N.tips.length>0&&e.jsxs("div",{className:"bg-amber-50 rounded-lg p-3 border border-amber-100",children:[e.jsx("h4",{className:"font-semibold text-amber-700 mb-1 text-sm",children:"温馨提示"}),e.jsx("ul",{className:"space-y-0.5",children:N.tips.map((k,O)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"flex-shrink-0 h-4 w-4 rounded-full bg-amber-100 text-amber-700 text-xs flex items-center justify-center mr-1.5 mt-0.5 font-bold",children:O+1}),e.jsx("span",{className:"text-gray-700 text-xs",children:k})]},O))})]}),e.jsx("div",{className:"mt-3 flex justify-center",children:e.jsx("button",{type:"button",className:"w-full px-4 py-2.5 bg-orange-500 text-white font-medium rounded-md text-sm shadow-sm hover:bg-orange-600 transition-colors cursor-default",children:"去点餐"})})]})]}),e.jsx("p",{className:"text-xs text-gray-500 text-center mt-2",children:"↑ 弹窗预览效果 ↑"})]})})]}),e.jsxs("div",{className:"hidden",children:["预览更新次数: ",j]})]})},Qe=async(t,a)=>{try{console.log(`🔄 正在从Firebase加载${t}数据...`);const s=await H.getSetting(t);if(s!=null)return console.log(`✅ 从Firebase加载了${t}数据`),s;console.log(`⚠️ Firebase没有${t}数据，尝试从localStorage加载...`);const r=localStorage.getItem(t);if(r){const n=JSON.parse(r);console.log(`🚀 正在迁移${t}数据到Firebase...`);try{await H.setSetting(t,n),console.log(`✅ ${t}数据迁移到Firebase成功`)}catch(i){console.error(`❌ ${t}数据迁移失败:`,i)}return n}return a}catch(s){console.error(`❌ 加载${t}数据失败:`,s);try{const r=localStorage.getItem(t);return r?JSON.parse(r):a}catch(r){return console.error(`❌ 从localStorage加载${t}数据也失败:`,r),a}}},ie=async(t,a)=>{try{localStorage.setItem(t,JSON.stringify(a));try{await H.setSetting(t,a),console.log(`✅ ${t}数据已保存到Firebase`)}catch(r){console.error(`❌ 保存${t}数据到Firebase失败:`,r)}const s=new CustomEvent(`${t}Update`,{detail:a});window.dispatchEvent(s)}catch(s){console.error(`保存${t}数据失败:`,s)}},Rr=()=>{const[t,a]=m.useState({name:"美食之家",logo:"https://images.pexels.com/photos/6287525/pexels-photo-6287525.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1"}),[s,r]=m.useState(Se),[n,i]=m.useState([{id:"1",type:"amount",threshold:100,value:10,description:"满100减10元"},{id:"2",type:"amount",threshold:200,value:20,description:"满200减20元"},{id:"3",type:"percentage",threshold:300,value:15,description:"满300享85折"}]),[o,h]=m.useState({type:"amount",threshold:100,value:10}),[x,y]=m.useState(!1),[N,d]=m.useState("basic");m.useEffect(()=>{(async()=>{try{const[l,c,v]=await Promise.all([Qe("restaurantInfo",{name:"美食之家",logo:"https://images.pexels.com/photos/6287525/pexels-photo-6287525.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1"}),Qe("announcementData",Se),Qe("discounts",[{id:"1",type:"amount",threshold:100,value:10,description:"满100减10元"},{id:"2",type:"amount",threshold:200,value:20,description:"满200减20元"},{id:"3",type:"percentage",threshold:300,value:15,description:"满300享85折"}])]);a(l),r(c),i(v),console.log("✅ 所有设置数据加载完成")}catch(l){console.error("❌ 加载设置数据失败:",l)}})()},[]),m.useEffect(()=>{t.name!=="美食之家"&&ie("restaurantInfo",t)},[t]),m.useEffect(()=>{ie("discounts",n)},[n]),m.useEffect(()=>{const u=v=>{v.detail&&JSON.stringify(t)!==JSON.stringify(v.detail)&&a(v.detail)},l=v=>{v.detail&&JSON.stringify(s)!==JSON.stringify(v.detail)&&r(v.detail)},c=v=>{v.detail&&JSON.stringify(n)!==JSON.stringify(v.detail)&&i(v.detail)};return window.addEventListener("restaurantInfoUpdate",u),window.addEventListener("announcementDataUpdate",l),window.addEventListener("discountsUpdate",c),()=>{window.removeEventListener("restaurantInfoUpdate",u),window.removeEventListener("announcementDataUpdate",l),window.removeEventListener("discountsUpdate",c)}},[t,s,n]);const j=u=>{u.preventDefault(),ie("restaurantInfo",t),alert("餐厅信息已更新")},S=async u=>{try{r(u),await ie("announcementData",u),localStorage.removeItem("hasShownAnnouncementModal");const l=new CustomEvent("announcementUpdate",{detail:u,bubbles:!0,cancelable:!0});document.dispatchEvent(l),window.dispatchEvent(l),sessionStorage.setItem("announcement_updated","true"),sessionStorage.setItem("announcement_updated_time",String(new Date().getTime())),alert("公告信息已更新并保存到云端！所有用户将在刷新页面后看到新内容。")}catch(l){console.error("保存公告数据失败:",l),alert("保存失败，请重试")}},w=u=>{u.preventDefault();let l="";o.type==="amount"?l=`满${o.threshold}减${o.value}元`:l=`满${o.threshold}享${100-o.value}折`;const c={id:`discount-${Date.now()}`,...o,description:l},v=[...n,c];i(v),ie("discounts",v),h({type:"amount",threshold:100,value:10}),y(!1)},b=u=>{const l=n.filter(c=>c.id!==u);i(l),ie("discounts",l)},p=()=>{const u={orders:0,cartItems:0,menuItems:0,categories:0,totalDataSize:0};try{const l=localStorage.getItem("orders"),c=localStorage.getItem("cart"),v=localStorage.getItem("menuItems"),C=localStorage.getItem("categories");if(l){const D=JSON.parse(l);u.orders=Array.isArray(D)?D.length:0}if(c){const D=JSON.parse(c);u.cartItems=Array.isArray(D)?D.length:0}if(v){const D=JSON.parse(v);u.menuItems=Array.isArray(D)?D.length:0}if(C){const D=JSON.parse(C);u.categories=Array.isArray(D)?D.length:0}let E=0;for(let D in localStorage)localStorage.hasOwnProperty(D)&&(E+=localStorage[D].length);u.totalDataSize=Math.round(E/1024*100)/100}catch(l){console.error("获取数据统计失败:",l)}return u},g=()=>{const u="确认重置";if(prompt(`⚠️ 警告：此操作将清除所有系统数据，包括：
      
• 所有历史订单记录
• 购物车数据
• 菜单设置
• 餐厅信息设置
• 公告设置
• 优惠活动设置
• 用户登录状态

此操作无法撤销！

如果您确定要继续，请在下方输入"${u}"：`)===u)try{const c=["orders","cart","menuItems","categories","restaurantInfo","announcementData","discounts","isAuthenticated","user","hasShownAnnouncementModal","deletedOrders"];c.forEach(v=>{localStorage.removeItem(v)}),c.forEach(v=>{const C=new CustomEvent(`${v}Update`,{detail:null});window.dispatchEvent(C)}),a({name:"美食之家",logo:"https://images.pexels.com/photos/6287525/pexels-photo-6287525.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1"}),r(Se),i([{id:"1",type:"amount",threshold:100,value:10,description:"满100减10元"},{id:"2",type:"amount",threshold:200,value:20,description:"满200减20元"},{id:"3",type:"percentage",threshold:300,value:15,description:"满300享85折"}]),alert("✅ 系统数据已全部重置！页面将自动刷新。"),setTimeout(()=>{window.location.reload()},2e3)}catch(c){console.error("重置数据失败:",c),alert("❌ 重置失败，请重试或联系管理员。")}},f=()=>{if(confirm("确定只清理订单数据吗？这将删除所有历史订单记录。"))try{console.log("🧹 开始清理订单数据..."),localStorage.removeItem("orders"),localStorage.removeItem("cart"),localStorage.removeItem("deletedOrders"),console.log("📤 发送清理事件...");const u=new CustomEvent("orderUpdate",{detail:[]}),l=new CustomEvent("cartUpdate",{detail:[]});window.dispatchEvent(u),window.dispatchEvent(l),console.log("✅ 清理事件已发送"),alert("✅ 订单数据已清理完成！")}catch(u){console.error("❌ 清理订单数据失败:",u),alert("❌ 清理失败，请重试。")}};return e.jsxs("div",{children:[e.jsx("h1",{className:"mb-6 text-2xl font-bold text-gray-900",children:"系统设置"}),e.jsx("div",{className:"mb-6 border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>d("basic"),className:`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${N==="basic"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"基本信息"}),e.jsx("button",{onClick:()=>d("announcement"),className:`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${N==="announcement"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"公告设置"}),e.jsx("button",{onClick:()=>d("discount"),className:`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${N==="discount"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"优惠活动"}),e.jsx("button",{onClick:()=>d("dataManagement"),className:`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${N==="dataManagement"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"数据管理"})]})}),N==="basic"&&e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsx("h2",{className:"font-semibold text-gray-800",children:"餐厅基本信息"})}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:j,children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"餐厅名称"}),e.jsx("input",{type:"text",value:t.name,onChange:u=>a({...t,name:u.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Logo URL"}),e.jsx("input",{type:"text",value:t.logo,onChange:u=>a({...t,logo:u.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{type:"submit",className:"flex items-center gap-1 rounded-md bg-orange-500 px-4 py-2 text-sm font-medium text-white hover:bg-orange-600",children:[e.jsx(_a,{className:"h-4 w-4"}),"保存设置"]})})]})})]}),N==="announcement"&&e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsx("h2",{className:"font-semibold text-gray-800",children:"公告信息设置"})}),e.jsx("div",{className:"p-6",children:e.jsx($r,{initialData:s,onSave:S})})]}),N==="discount"&&e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 px-6 py-4",children:[e.jsx("h2",{className:"font-semibold text-gray-800",children:"优惠活动设置"}),e.jsxs("button",{onClick:()=>y(!x),className:"flex items-center gap-1 rounded-md bg-orange-500 px-3 py-1 text-sm font-medium text-white hover:bg-orange-600",children:[e.jsx(Q,{className:"h-4 w-4"}),"添加优惠"]})]}),e.jsxs("div",{className:"p-6",children:[x&&e.jsxs("div",{className:"mb-6 rounded-lg border border-gray-200 bg-gray-50 p-4",children:[e.jsx("h3",{className:"mb-3 font-medium text-gray-700",children:"添加新优惠"}),e.jsxs("form",{onSubmit:w,className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"优惠类型"}),e.jsxs("select",{value:o.type,onChange:u=>h({...o,type:u.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500",children:[e.jsx("option",{value:"amount",children:"满减优惠"}),e.jsx("option",{value:"percentage",children:"折扣优惠"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"满足金额"}),e.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"€"})}),e.jsx("input",{type:"number",min:"0",value:o.threshold,onChange:u=>h({...o,threshold:parseInt(u.target.value)}),className:"block w-full rounded-md border border-gray-300 px-3 py-2 pl-7 shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:o.type==="amount"?"减免金额":"折扣比例 (%)"}),e.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[o.type==="amount"&&e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"€"})}),e.jsx("input",{type:"number",min:"0",max:o.type==="percentage"?100:void 0,value:o.value,onChange:u=>h({...o,value:parseInt(u.target.value)}),className:`block w-full rounded-md border border-gray-300 px-3 py-2 ${o.type==="amount"?"pl-7":""} shadow-sm focus:border-orange-500 focus:outline-none focus:ring-1 focus:ring-orange-500`}),o.type==="percentage"&&e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"%"})})]})]}),e.jsxs("div",{className:"md:col-span-3 flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>y(!1),className:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",children:"取消"}),e.jsx("button",{type:"submit",className:"rounded-md bg-orange-500 px-4 py-2 text-sm font-medium text-white hover:bg-orange-600",children:"添加"})]})]})]}),n.length===0?e.jsx("div",{className:"rounded-lg border border-dashed border-gray-300 p-6 text-center",children:e.jsx("p",{className:"text-gray-500",children:"暂无优惠活动"})}):e.jsx("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"优惠描述"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"类型"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"满足金额"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"优惠值"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500",children:"操作"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:n.map(u=>e.jsxs("tr",{children:[e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm font-medium text-gray-900",children:u.description}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500",children:u.type==="amount"?"满减":"折扣"}),e.jsxs("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500",children:["€",u.threshold]}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500",children:u.type==="amount"?`€${u.value}`:`${100-u.value}%`}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-right text-sm font-medium",children:e.jsx("button",{onClick:()=>b(u.id),className:"text-red-500 hover:text-red-700",children:e.jsx(G,{className:"h-4 w-4"})})})]},u.id))})]})})]})]}),N==="dataManagement"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsxs("h2",{className:"flex items-center gap-2 font-semibold text-gray-800",children:[e.jsx(de,{className:"h-5 w-5"}),"数据统计"]})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-4",children:(()=>{const u=p();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-lg border border-gray-200 p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:u.orders}),e.jsx("div",{className:"text-sm text-gray-500",children:"历史订单"})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:u.menuItems}),e.jsx("div",{className:"text-sm text-gray-500",children:"菜单项目"})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:u.categories}),e.jsx("div",{className:"text-sm text-gray-500",children:"菜品分类"})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[u.totalDataSize,"KB"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"总数据大小"})]})]})})()})})]}),e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsxs("h2",{className:"flex items-center gap-2 font-semibold text-gray-800",children:[e.jsx(Zt,{className:"h-5 w-5"}),"数据清理"]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"rounded-lg border border-yellow-200 bg-yellow-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ue,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-yellow-800 mb-2",children:"清理订单数据"}),e.jsx("p",{className:"text-sm text-yellow-700 mb-3",children:"清理所有历史订单记录和购物车数据，保留菜单设置、餐厅信息等其他配置。"}),e.jsxs("button",{onClick:f,className:"inline-flex items-center gap-2 rounded-md bg-yellow-600 px-3 py-2 text-sm font-medium text-white hover:bg-yellow-700",children:[e.jsx(G,{className:"h-4 w-4"}),"清理订单数据"]})]})]})}),e.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ue,{className:"h-5 w-5 text-red-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-red-800 mb-2",children:"重置所有数据"}),e.jsxs("p",{className:"text-sm text-red-700 mb-3",children:["⚠️ ",e.jsx("strong",{children:"危险操作"}),"：将清除所有系统数据，包括订单、菜单、设置等所有信息，恢复到初始状态。此操作不可撤销！"]}),e.jsxs("ul",{className:"text-xs text-red-600 mb-3 list-disc list-inside space-y-1",children:[e.jsx("li",{children:"所有历史订单记录"}),e.jsx("li",{children:"菜单项目和分类设置"}),e.jsx("li",{children:"餐厅信息和公告设置"}),e.jsx("li",{children:"优惠活动配置"}),e.jsx("li",{children:"用户登录状态"})]}),e.jsxs("button",{onClick:g,className:"inline-flex items-center gap-2 rounded-md bg-red-600 px-3 py-2 text-sm font-medium text-white hover:bg-red-700",children:[e.jsx(de,{className:"h-4 w-4"}),"重置所有数据"]})]})]})}),e.jsx("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(de,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-blue-800 mb-2",children:"使用说明"}),e.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("p",{children:"• 建议在系统测试或新部署时使用数据重置功能"}),e.jsx("p",{children:"• 重置操作会要求输入确认文本以防止误操作"}),e.jsx("p",{children:"• 清理后页面会自动刷新以应用更改"}),e.jsx("p",{children:"• 如需备份数据，请在操作前导出相关信息"})]})]})]})})]})]})]})]})},Lr=()=>{const[t,a]=m.useState("week"),[s,r]=m.useState(!1),{orders:n}=fe(),i=m.useMemo(()=>{const d=new Date,j=new Date;switch(t){case"today":j.setHours(0,0,0,0);break;case"week":const S=d.getDay(),w=S===0?6:S-1;j.setDate(d.getDate()-w),j.setHours(0,0,0,0);break;case"month":j.setDate(1),j.setHours(0,0,0,0);break;case"year":j.setMonth(0,1),j.setHours(0,0,0,0);break;default:return n}return n.filter(S=>{const w=new Date(S.createdAt);return w>=j&&w<=d})},[n,t]),o=m.useMemo(()=>{const d=i.reduce((l,c)=>l+c.total,0),j=i.length,S=j>0?d/j:0,w=new Map;i.forEach(l=>{l.items.forEach(c=>{let v=c.menuItem.name,C=c.menuItem.name;c.variant&&c.variant.trim()!==""&&(C+=` (${c.variant})`,v+=`_${c.variant}`),c.special&&c.special.trim()!==""&&(C+=` - ${c.special}`,v+=`_${c.special}`);const E=w.get(v)||{quantity:0,revenue:0,displayName:C,baseItemName:c.menuItem.name,variant:c.variant||"",special:c.special||""},D=c.calculatedPrice||c.menuItem.price;w.set(v,{...E,quantity:E.quantity+c.quantity,revenue:E.revenue+D*c.quantity})})});const b=Array.from(w.entries()).map(([,l])=>({name:l.displayName,baseItemName:l.baseItemName,variant:l.variant,special:l.special,quantity:l.quantity,revenue:l.revenue})).sort((l,c)=>c.quantity-l.quantity).slice(0,10),p=new Map;i.forEach(l=>{const c=l.groupName,v=p.get(c)||{orderCount:0,totalSpent:0,itemCount:0,avgOrderValue:0},C=l.items.reduce((D,R)=>D+R.quantity,0),E={orderCount:v.orderCount+1,totalSpent:v.totalSpent+l.total,itemCount:v.itemCount+C,avgOrderValue:0};E.avgOrderValue=E.totalSpent/E.orderCount,p.set(c,E)});const g=Array.from(p.entries()).map(([l,c])=>({name:l,...c})).sort((l,c)=>c.orderCount-l.orderCount).slice(0,8),f=[],u=["周日","周一","周二","周三","周四","周五","周六"];for(let l=6;l>=0;l--){const c=new Date;c.setDate(c.getDate()-l),c.setHours(0,0,0,0);const v=new Date(c);v.setDate(v.getDate()+1);const E=n.filter(D=>{const R=new Date(D.createdAt);return R>=c&&R<v}).reduce((D,R)=>D+R.total,0);f.push({day:u[c.getDay()],sales:E})}return{totalRevenue:d,totalOrders:j,averageOrderValue:S,topSellingItems:b,topCustomers:g,dailySales:f}},[i,n]),h=()=>{if(confirm("确定要清理所有订单数据吗？这将删除所有历史订单记录，统计数据将重置为0。"))try{localStorage.removeItem("orders"),localStorage.removeItem("cart"),localStorage.removeItem("deletedOrders");const d=new CustomEvent("orderUpdate",{detail:[]}),j=new CustomEvent("cartUpdate",{detail:[]});window.dispatchEvent(d),window.dispatchEvent(j),alert("✅ 订单数据已清理完成！统计数据已重置。")}catch(d){console.error("清理订单数据失败:",d),alert("❌ 清理失败，请重试。")}},x=()=>{try{const d={exportTime:new Date().toLocaleString("zh-CN"),timeRange:t,summary:{totalRevenue:o.totalRevenue,totalOrders:o.totalOrders,averageOrderValue:o.averageOrderValue,totalCustomers:o.topCustomers.length},orders:n,topSellingItems:o.topSellingItems,topCustomers:o.topCustomers};let j="";j+=`报表导出时间,${d.exportTime}
`,j+=`统计时间范围,${t==="today"?"今日":t==="week"?"本周":t==="month"?"本月":"本年"}

`,j+=`汇总统计
`,j+=`总销售额,€${d.summary.totalRevenue.toFixed(1)}
`,j+=`总订单数,${d.summary.totalOrders}
`,j+=`平均客单价,€${d.summary.averageOrderValue.toFixed(1)}
`,j+=`活跃用户数,${d.summary.totalCustomers}

`,j+=`热销菜品排行
`,j+=`排名,菜品名称,规格,选项,销售数量,销售金额
`,d.topSellingItems.forEach((g,f)=>{j+=`${f+1},${g.baseItemName},${g.variant||""},${g.special||""},${g.quantity},€${g.revenue.toFixed(1)}
`}),j+=`
`,j+=`用户点餐排行
`,j+=`排名,用户名称,订单数量,菜品数量,消费总额,平均客单价
`,d.topCustomers.forEach((g,f)=>{j+=`${f+1},${g.name},${g.orderCount},${g.itemCount},€${g.totalSpent.toFixed(1)},€${g.avgOrderValue.toFixed(1)}
`}),j+=`
`,d.orders.length>0&&(j+=`详细订单数据
`,j+=`订单号,取餐码,群昵称,订单时间,订单状态,商品数量,订单金额,备注
`,d.orders.filter(f=>{const u=f.createdAt instanceof Date?f.createdAt:new Date(f.createdAt);if(t==="today"){const l=new Date;return u.toDateString()===l.toDateString()}else if(t==="week"){const l=new Date;return l.setDate(l.getDate()-7),u>=l}else if(t==="month"){const l=new Date;return l.setMonth(l.getMonth()-1),u>=l}else if(t==="year"){const l=new Date;return l.setFullYear(l.getFullYear()-1),u>=l}return!0}).forEach(f=>{const u=(f.createdAt instanceof Date?f.createdAt:new Date(f.createdAt)).toLocaleString("zh-CN"),l={pending:"待处理",preparing:"制作中",ready:"可取餐",completed:"已完成",cancelled:"已取消"}[f.status]||f.status;j+=`${f.id},${f.pickupCode},${f.groupName},${u},${l},${f.items.reduce((c,v)=>c+v.quantity,0)},€${f.total.toFixed(1)},${f.notes||""}
`}));const S=new Blob(["\uFEFF"+j],{type:"text/csv;charset=utf-8;"}),w=document.createElement("a"),p=`美食之家_${{today:"今日",week:"本周",month:"本月",year:"本年"}[t]||t}报表_${new Date().toISOString().slice(0,10)}.csv`;if(w.download!==void 0){const g=URL.createObjectURL(S);w.setAttribute("href",g),w.setAttribute("download",p),w.style.visibility="hidden",document.body.appendChild(w),w.click(),document.body.removeChild(w),alert(`📊 报表导出成功！
文件名: ${p}`)}else alert("❌ 浏览器不支持文件下载功能")}catch(d){console.error("导出报表失败:",d),alert("❌ 导出报表失败，请重试")}},y=()=>{const d="确认重置";if(prompt(`⚠️ 警告：此操作将清除所有系统数据，包括：
      
• 所有历史订单记录
• 购物车数据
• 菜单设置
• 餐厅信息设置
• 公告设置
• 优惠活动设置
• 用户登录状态

此操作无法撤销！统计数据将完全重置！

如果您确定要继续，请在下方输入"${d}"：`)===d)try{const S=["orders","cart","menuItems","categories","restaurantInfo","announcementData","discounts","isAuthenticated","user","hasShownAnnouncementModal","deletedOrders"];S.forEach(w=>{localStorage.removeItem(w)}),S.forEach(w=>{const b=new CustomEvent(`${w}Update`,{detail:null});window.dispatchEvent(b)}),alert("✅ 系统数据已全部重置！页面将自动刷新。"),setTimeout(()=>{window.location.reload()},2e3)}catch(S){console.error("重置数据失败:",S),alert("❌ 重置失败，请重试或联系管理员。")}},N=()=>{const{dailySales:d}=o,j=d.length>0?Math.max(...d.map(S=>S.sales)):1;return e.jsx("div",{className:"mt-4 h-64",children:e.jsx("div",{className:"flex h-full items-end",children:d.map((S,w)=>e.jsxs("div",{className:"flex flex-1 flex-col items-center",children:[e.jsx("div",{className:"relative w-full max-w-[40px] bg-orange-500 transition-all duration-500 hover:bg-orange-600",style:{height:`${S.sales/j*100}%`,animation:`grow 1s ease-out ${w*.1}s`},children:e.jsxs("div",{className:"absolute -top-7 left-1/2 -translate-x-1/2 whitespace-nowrap text-xs font-medium text-gray-600",children:["€",S.sales]})}),e.jsx("div",{className:"mt-2 text-xs text-gray-500",children:S.day})]},w))})})};return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6 flex flex-col justify-between gap-4 sm:flex-row sm:items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"数据统计"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>r(!s),className:"flex items-center gap-1 rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",children:[t==="today"&&"今日",t==="week"&&"本周",t==="month"&&"本月",t==="year"&&"本年",e.jsx(dt,{className:"h-4 w-4"})]}),s&&e.jsx("div",{className:"absolute right-0 z-10 mt-1 w-40 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5",children:e.jsxs("div",{className:"py-1",children:[e.jsx("button",{onClick:()=>{a("today"),r(!1)},className:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100",children:"今日"}),e.jsx("button",{onClick:()=>{a("week"),r(!1)},className:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100",children:"本周"}),e.jsx("button",{onClick:()=>{a("month"),r(!1)},className:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100",children:"本月"}),e.jsx("button",{onClick:()=>{a("year"),r(!1)},className:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100",children:"本年"})]})})]}),e.jsxs("button",{onClick:h,className:"flex items-center gap-1 rounded-md bg-yellow-600 px-4 py-2 text-sm font-medium text-white hover:bg-yellow-700",children:[e.jsx(G,{className:"h-4 w-4"}),"清理订单"]}),e.jsxs("button",{onClick:y,className:"flex items-center gap-1 rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700",children:[e.jsx(Zt,{className:"h-4 w-4"}),"重置数据"]}),e.jsxs("button",{onClick:x,className:"flex items-center gap-1 rounded-md bg-green-600 px-4 py-2 text-sm font-medium text-white hover:bg-green-700",children:[e.jsx(Ma,{className:"h-4 w-4"}),"导出报表"]})]})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"总销售额"}),o.totalRevenue>0?e.jsx("span",{className:"inline-flex rounded-full bg-green-100 px-2 py-0.5 text-xs font-medium text-green-800",children:"实时数据"}):e.jsx("span",{className:"inline-flex rounded-full bg-gray-100 px-2 py-0.5 text-xs font-medium text-gray-600",children:"暂无数据"})]}),e.jsxs("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:["€",o.totalRevenue.toFixed(1)]}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:[t==="today"&&"今日营业额",t==="week"&&"本周营业额",t==="month"&&"本月营业额",t==="year"&&"本年营业额"]})]}),e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"总订单数"}),o.totalOrders>0?e.jsx("span",{className:"inline-flex rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-800",children:"实时数据"}):e.jsx("span",{className:"inline-flex rounded-full bg-gray-100 px-2 py-0.5 text-xs font-medium text-gray-600",children:"暂无数据"})]}),e.jsx("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:o.totalOrders}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:[t==="today"&&"今日订单",t==="week"&&"本周订单",t==="month"&&"本月订单",t==="year"&&"本年订单"]})]}),e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"平均客单价"}),o.averageOrderValue>0?e.jsx("span",{className:"inline-flex rounded-full bg-purple-100 px-2 py-0.5 text-xs font-medium text-purple-800",children:"实时数据"}):e.jsx("span",{className:"inline-flex rounded-full bg-gray-100 px-2 py-0.5 text-xs font-medium text-gray-600",children:"暂无数据"})]}),e.jsxs("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:["€",o.averageOrderValue.toFixed(1)]}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:["基于 ",o.totalOrders," 个订单计算"]})]})]}),e.jsxs("div",{className:"mb-6 overflow-hidden rounded-lg bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"font-semibold text-gray-800",children:"销售额趋势"}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(tt,{className:"mr-1 h-4 w-4"}),t==="today"&&"今日",t==="week"&&"本周",t==="month"&&"本月",t==="year"&&"本年"]})]})}),e.jsx("div",{className:"p-6",children:N()})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsx("h2",{className:"font-semibold text-gray-800",children:"热销菜品排行（含规格）"})}),e.jsx("div",{className:"p-6",children:o.topSellingItems.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(tt,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"暂无销售数据"})]}):e.jsx("div",{className:"space-y-3",children:o.topSellingItems.map((d,j)=>e.jsxs("div",{className:"flex items-start justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:`flex h-6 w-6 items-center justify-center rounded-full text-white text-xs font-bold flex-shrink-0 ${j===0?"bg-yellow-500":j===1?"bg-gray-400":j===2?"bg-amber-600":"bg-blue-500"}`,children:j+1}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"font-medium text-gray-900 text-sm",children:d.baseItemName}),(d.variant||d.special)&&e.jsxs("div",{className:"mt-1 space-y-1",children:[d.variant&&d.variant.trim()!==""&&e.jsxs("p",{className:"text-xs text-blue-600",children:["规格: ",d.variant]}),d.special&&d.special.trim()!==""&&e.jsxs("p",{className:"text-xs text-green-600",children:["选项: ",d.special]})]})]})]}),e.jsxs("div",{className:"text-right flex-shrink-0 ml-4",children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[d.quantity," 份"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["€",d.revenue.toFixed(1)]})]})]},j))})})]}),e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsx("h2",{className:"font-semibold text-gray-800",children:"用户点餐量排行"})}),e.jsx("div",{className:"p-6",children:o.topCustomers.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(nt,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"暂无用户数据"})]}):e.jsx("div",{className:"space-y-3",children:o.topCustomers.map((d,j)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`flex h-8 w-8 items-center justify-center rounded-full text-white text-sm font-bold ${j===0?"bg-yellow-500":j===1?"bg-gray-400":j===2?"bg-amber-600":"bg-blue-500"}`,children:j+1}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:d.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[d.orderCount," 单 • ",d.itemCount," 个菜品"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:["€",d.totalSpent.toFixed(1)]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["平均 €",d.avgOrderValue.toFixed(1),"/单"]})]})]},d.name))})})]}),e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsx("h2",{className:"font-semibold text-gray-800",children:"销售额占比"})}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"relative flex h-40 w-40 items-center justify-center rounded-full bg-gray-100",children:[e.jsxs("svg",{className:"absolute inset-0",viewBox:"0 0 100 100",children:[e.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#E5E7EB",strokeWidth:"20"}),e.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#F97316",strokeWidth:"20",strokeDasharray:`${40*2.51} ${100*2.51}`,strokeDashoffset:"0"}),e.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#3B82F6",strokeWidth:"20",strokeDasharray:`${25*2.51} ${100*2.51}`,strokeDashoffset:`${-40*2.51}`}),e.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#10B981",strokeWidth:"20",strokeDasharray:`${20*2.51} ${100*2.51}`,strokeDashoffset:`${-65*2.51}`}),e.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#A855F7",strokeWidth:"20",strokeDasharray:`${15*2.51} ${100*2.51}`,strokeDashoffset:`${-85*2.51}`})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"总计"}),e.jsxs("div",{className:"text-xl font-bold text-gray-800",children:["€",o.totalRevenue.toFixed(1)]})]})]})}),e.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-orange-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"主食类 (40%)"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-blue-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"小吃类 (25%)"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-green-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"饮料类 (20%)"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-purple-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"其他 (15%)"})]})]})]})]})]}),e.jsxs("div",{className:"mt-8 space-y-4",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-lg font-semibold text-gray-800",children:[e.jsx(de,{className:"h-5 w-5"}),"数据管理与重置"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-5",children:[e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"历史订单总数"})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["€",n.reduce((d,j)=>d+j.total,0).toFixed(1)]}),e.jsx("div",{className:"text-sm text-gray-500",children:"累计营业额"})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:o.totalOrders}),e.jsx("div",{className:"text-sm text-gray-500",children:"当前筛选期间订单"})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[Math.round(JSON.stringify(n).length/1024*100)/100,"KB"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"订单数据大小"})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:o.topCustomers.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"活跃用户数"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsx("div",{className:"rounded-lg border border-yellow-200 bg-yellow-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ue,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-yellow-800 mb-2",children:"清理订单数据"}),e.jsx("p",{className:"text-sm text-yellow-700 mb-3",children:"清理所有历史订单记录，统计数据将重置为0。此操作不会影响菜单设置和其他配置。"}),e.jsxs("button",{onClick:h,className:"inline-flex items-center gap-2 rounded-md bg-yellow-600 px-3 py-2 text-sm font-medium text-white hover:bg-yellow-700",children:[e.jsx(G,{className:"h-4 w-4"}),"清理所有订单数据"]})]})]})}),e.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ue,{className:"h-5 w-5 text-red-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-red-800 mb-2",children:"重置所有系统数据"}),e.jsxs("p",{className:"text-sm text-red-700 mb-3",children:["⚠️ ",e.jsx("strong",{children:"危险操作"}),"：将清除所有系统数据，包括订单、菜单、设置等，恢复到初始状态。"]}),e.jsxs("button",{onClick:y,className:"inline-flex items-center gap-2 rounded-md bg-red-600 px-3 py-2 text-sm font-medium text-white hover:bg-red-700",children:[e.jsx(de,{className:"h-4 w-4"}),"重置所有系统数据"]})]})]})})]}),e.jsx("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(de,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-blue-800 mb-2",children:"统计数据说明"}),e.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("p",{children:"• 统计数据基于实际订单记录实时计算，与订单数据完全同步"}),e.jsx("p",{children:"• 使用时间筛选可查看不同时期的数据统计"}),e.jsx("p",{children:"• 清理订单数据后，所有统计图表将重置为0"}),e.jsx("p",{children:"• 数据重置操作不可撤销，请谨慎操作"})]})]})]})})]})]})},Pr=()=>{const{orders:t}=fe(),a=r=>{if(!r)return[];const n=[];return r.split("、").map(o=>o.trim()).forEach(o=>{var h;if(o.includes("选择日期:")){const x=(h=o.split("选择日期:")[1])==null?void 0:h.trim();x&&x.split("、").map(N=>N.trim()).forEach(N=>{N&&n.push(`选择日期: ${N}`)})}else o.includes(":"),n.push(o)}),n},s=m.useMemo(()=>{const r=new Map;return t.filter(i=>i.status==="pending"||i.status==="preparing"||i.status==="ready").forEach(i=>{i.items.forEach(o=>{let h=o.menuItem.name,x=o.menuItem.name;o.variant&&o.variant.trim()!==""&&(x+=` (${o.variant})`,h+=`_${o.variant}`),o.special&&o.special.trim()!==""&&(x+=` - ${o.special}`,h+=`_${o.special}`),r.has(h)||r.set(h,{name:x,totalQuantity:0,options:new Map,baseItemName:o.menuItem.name,variant:o.variant||"",special:o.special||""});const y=r.get(h);y.totalQuantity+=o.quantity,o.special&&a(o.special).forEach(d=>{const j=y.options.get(d)||0;y.options.set(d,j+o.quantity)})})}),Array.from(r.values()).sort((i,o)=>o.totalQuantity-i.totalQuantity)},[t]);return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"备餐统计"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"统计未完成订单的菜品需求，优化备餐计划"})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx("div",{className:"rounded-lg bg-white p-6 shadow-sm border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-blue-100",children:e.jsx(at,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"菜品种类"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:s.length})]})]})}),e.jsx("div",{className:"rounded-lg bg-white p-6 shadow-sm border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-orange-100",children:e.jsx(ct,{className:"h-6 w-6 text-orange-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"总菜品数"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:s.reduce((r,n)=>r+n.totalQuantity,0)})]})]})}),e.jsx("div",{className:"rounded-lg bg-white p-6 shadow-sm border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-yellow-100",children:e.jsx(ee,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"待处理订单"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:t.filter(r=>r.status==="pending").length})]})]})}),e.jsx("div",{className:"rounded-lg bg-white p-6 shadow-sm border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-green-100",children:e.jsx(rt,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"制作中订单"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:t.filter(r=>r.status==="preparing").length})]})]})})]}),e.jsx("div",{className:"space-y-6",children:s.map(r=>e.jsxs("div",{className:"rounded-lg bg-white p-6 shadow-sm border",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:r.baseItemName}),(r.variant||r.special)&&e.jsxs("div",{className:"mt-1 space-y-1",children:[r.variant&&r.variant.trim()!==""&&e.jsxs("p",{className:"text-sm text-blue-600",children:["规格: ",r.variant]}),r.special&&r.special.trim()!==""&&e.jsxs("p",{className:"text-sm text-green-600",children:["选项: ",r.special]})]})]}),e.jsxs("span",{className:"rounded-full bg-gray-100 px-3 py-1 text-sm font-medium text-gray-600",children:["总计 ",r.totalQuantity," 份"]})]}),r.options.size>0&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"详细规格选择"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"数量"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:Array.from(r.options.entries()).sort(([,n],[,i])=>i-n).map(([n,i])=>e.jsxs("tr",{children:[e.jsx("td",{className:"whitespace-nowrap px-4 py-4 text-sm text-gray-900",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:n})}),e.jsx("td",{className:"whitespace-nowrap px-4 py-4 text-sm font-medium text-gray-600",children:e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[i," 份"]})})]},n))})]})}),r.options.size===0&&e.jsx("div",{className:"text-center py-4 text-gray-500",children:e.jsx("p",{className:"text-sm",children:"此菜品无特殊规格要求"})})]},r.name))}),s.length===0&&e.jsxs("div",{className:"rounded-lg bg-white p-12 text-center shadow-sm border",children:[e.jsx(tt,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"暂无未完成订单"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"当前没有需要备餐的订单"})]})]})},is=()=>{const{isAuthenticated:t}=Ie(),[a,s]=qe.useState(!0);return t?e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx(Or,{isOpen:a,onClose:()=>s(!1)}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(Cr,{}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:e.jsxs(Ht,{children:[e.jsx(_,{path:"/",element:e.jsx(we,{to:"dashboard",replace:!0})}),e.jsx(_,{path:"dashboard",element:e.jsx(Dr,{})}),e.jsx(_,{path:"orders",element:e.jsx(Er,{})}),e.jsx(_,{path:"menu",element:e.jsx(Ar,{})}),e.jsx(_,{path:"preparation",element:e.jsx(Pr,{})}),e.jsx(_,{path:"settings",element:e.jsx(Rr,{})}),e.jsx(_,{path:"statistics",element:e.jsx(Lr,{})}),e.jsx(_,{path:"*",element:e.jsx(we,{to:"dashboard",replace:!0})})]})})]})]}):e.jsx(we,{to:"/admin/login",replace:!0})},Fr="3.0.0",Tr=t=>{try{const a=localStorage.getItem("announcementData");if(a)return console.log("从本地存储获取公告数据:",a),JSON.parse(a)}catch(a){console.error("解析公告数据失败:",a)}return t},Ur=(t,a)=>{localStorage.removeItem("hasShownAnnouncementModal");const s=Tr(a);t(s);const r=n=>{console.log("收到公告更新事件:",n.detail),n.detail&&t(n.detail)};return window.addEventListener("announcementUpdate",r),document.addEventListener("announcementUpdate",r),()=>{window.removeEventListener("announcementUpdate",r),document.removeEventListener("announcementUpdate",r)}},At={isEnabled:!0,title:"📢 本周订餐公告",description:"请查看以下重要信息，以便顺利完成订餐",orderDate:"5.24",orderWeekday:"周五",orderDeadline:"5.24（周五）12:00",specialDeadline:"甜品截至5.23晚22:00",pickupTime:"18:00",pickupLocation:"蓝塔楼下",paymentMethods:["微信支付","支付宝","现金"],tips:["请在截单时间前完成订单提交，过时将无法接受订单","用餐高峰期请提前15分钟取餐","如需取消订单，请提前2小时联系客服"],promotionText:"本周特惠: 三份餐点八折优惠！"},qr=()=>{const{categories:t,menuItems:a,isLoading:s}=De(),{items:r,totalItems:n,subtotal:i,discount:o,total:h,clearCart:x}=Ee(),{createOrder:y}=fe(),{isAuthenticated:N}=Ie(),[d,j]=m.useState(()=>{const A=new URLSearchParams(window.location.search),I=A.has("admin");return console.log("🔍 CustomerApp初始化 - URL检测:",{url:window.location.href,search:window.location.search,hasAdmin:I,adminValue:A.get("admin"),showAdminMode:I}),I}),[S,w]=m.useState(""),[b,p]=m.useState(!1),[g,f]=m.useState(!1),[u,l]=m.useState(null),[c,v]=m.useState(!1),[C,E]=m.useState(!1),[D,R]=m.useState(At),B=m.useRef({}),ae=m.useRef(null),Me=m.useRef(null),V=m.useRef(null),[re,ye]=m.useState(null);console.log("当前公告组件版本:",Fr),m.useEffect(()=>{const A=()=>{const I=new URLSearchParams(window.location.search),F=I.has("admin");console.log("🔄 URL变化检测:",{url:window.location.href,search:window.location.search,hasAdmin:F,adminValue:I.get("admin")}),j(F)};return window.addEventListener("popstate",A),()=>window.removeEventListener("popstate",A)},[]),m.useEffect(()=>{if(d)return;try{localStorage.removeItem("hasShownAnnouncementModal"),console.log("localStorage状态:",{announcementData:localStorage.getItem("announcementData"),hasShownAnnouncementModal:localStorage.getItem("hasShownAnnouncementModal")})}catch(I){console.error("清除缓存失败:",I)}return Ur(I=>{console.log("forceAnnouncementSync收到数据:",I),R(I),setTimeout(()=>{E(!0)},500)},At)},[d]),m.useEffect(()=>{const A=I=>{console.log("收到公告更新事件:",I.detail),R(I.detail)};return window.addEventListener("announcementUpdate",A),document.addEventListener("announcementUpdate",A),()=>{window.removeEventListener("announcementUpdate",A),document.removeEventListener("announcementUpdate",A)}},[]),m.useEffect(()=>{t.length>0&&!S&&(w(t[0].id),ae.current=t[0].id)},[t,S]),m.useEffect(()=>{if(!t.length)return;const A=()=>{if(!Me.current)return;const I=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--header-height")||"0"),F=window.scrollY+I+50;let T=t[0].id,ne=1/0;Object.entries(B.current).forEach(([He,ht])=>{if(!ht)return;const{top:cs}=ht.getBoundingClientRect(),pt=cs+window.scrollY,gt=Math.abs(F-pt);gt<ne&&F>=pt&&(ne=gt,T=He)}),T&&T!==S&&w(T)};return window.addEventListener("scroll",A),setTimeout(A,100),()=>{window.removeEventListener("scroll",A)}},[t,S]),m.useEffect(()=>{document.documentElement.style.setProperty("--category-nav-width","96px");const A=()=>{const I=window.innerWidth>=768?"160px":"96px";document.documentElement.style.setProperty("--category-nav-width",I)};return A(),window.addEventListener("resize",A),()=>{window.removeEventListener("resize",A)}},[]);const Ae=A=>{if(w(A),B.current[A]){const I=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--header-height")||"0"),ne=B.current[A].getBoundingClientRect().top+window.pageYOffset-I-8;window.scrollTo({top:ne,behavior:"smooth"})}},Ve=()=>{E(!0)},We=()=>{E(!1),ae.current&&Ae(ae.current)},k=()=>{p(!b)},O=()=>{r.length!==0&&(p(!1),f(!0))},L=async(A,I)=>{console.log("🛒 CustomerApp.handleOrderSubmit 开始提交订单:",{groupName:A,notes:I,cartItemsCount:r.length,total:h,subtotal:i,discountSavings:o.savings});try{const F=await y(r,h,i,o.savings,A,I);console.log("✅ CustomerApp 订单提交完成:",{orderId:F.id,pickupCode:F.pickupCode}),l(F),f(!1),v(!0),x()}catch(F){console.error("❌ 订单提交失败:",F),alert("订单提交失败，请重试")}},$=()=>{v(!1),l(null)},P=(A,I,F)=>{if(!V.current)return;const T=V.current.getBoundingClientRect(),ne={x:T.left+T.width/2,y:T.top+T.height/2};ye({isActive:!0,productImage:A,startPosition:{x:I,y:F}});const He=new CustomEvent("fly-to-cart-animation",{detail:{endPosition:ne,onAnimationEnd:()=>ye(null)}});window.dispatchEvent(He)};return m.useEffect(()=>{const A=I=>{const{productImage:F,position:T}=I.detail;P(F,T.x,T.y)};return window.addEventListener("add-to-cart",A),()=>{window.removeEventListener("add-to-cart",A)}},[]),s&&!d?e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gray-50",children:e.jsx("div",{className:"animate-pulse text-center",children:e.jsx("div",{className:"text-xl font-semibold text-gray-600",children:"加载中..."})})}):d?(console.log("🎯 渲染管理员模式:",{showAdminMode:d,isAuthenticated:N}),N?e.jsx(is,{}):e.jsx(ls,{})):(console.log("🍽️ 渲染点餐界面:",{showAdminMode:d,isAuthenticated:N}),e.jsxs("div",{className:"flex min-h-screen flex-col bg-gray-50",children:[e.jsx(Ya,{hideAnnouncement:!1,onAnnouncementClick:Ve}),e.jsxs("div",{className:"flex flex-1 overflow-hidden relative",children:[e.jsxs("div",{className:"fixed top-[calc(var(--header-height,64px))] bottom-0 left-0 w-24 bg-white shadow-sm md:w-40 z-5",children:[e.jsx("div",{className:"h-full overflow-y-auto pb-20",children:e.jsx(Za,{categories:t,selectedCategory:S,onCategoryClick:Ae,showAnnouncement:!1})}),e.jsx("div",{ref:V,className:"absolute bottom-4 left-0 right-0 flex justify-center items-center",children:e.jsxs("button",{onClick:k,className:"relative flex h-14 w-14 items-center justify-center rounded-full bg-orange-500 text-white shadow-lg transition-transform hover:bg-orange-600 active:scale-95",children:[e.jsx(ue,{className:"h-6 w-6"}),n>0&&e.jsx("span",{className:"absolute -top-2 -right-2 flex h-6 w-6 items-center justify-center rounded-full bg-red-500 text-xs font-bold text-white shadow-sm",children:n})]})})]}),e.jsx("div",{ref:Me,className:"flex-1 overflow-y-auto px-4 pt-4 pb-32 ml-24 md:ml-40",children:e.jsx(dr,{menuItems:a,categories:t,categoryRefs:B})})]}),re&&e.jsx(gr,{isActive:re.isActive,productImage:re.productImage,startPosition:re.startPosition,endPosition:V.current?{x:V.current.getBoundingClientRect().left+V.current.getBoundingClientRect().width/2,y:V.current.getBoundingClientRect().top+V.current.getBoundingClientRect().height/2}:{x:0,y:0},onAnimationEnd:()=>ye(null)}),e.jsx(mr,{isOpen:b,onClose:()=>p(!1),onCheckout:O}),e.jsx(xr,{isOpen:g,onClose:()=>f(!1),onSubmit:L}),c&&u&&e.jsx(ur,{order:u,onClose:$}),e.jsx(pr,{data:D,isOpen:C,onClose:()=>E(!1),onOrderNow:We})]}))},zr=()=>e.jsx(fr,{children:e.jsx(ar,{children:e.jsx(kr,{children:e.jsx(lr,{children:e.jsxs(Ht,{children:[e.jsx(_,{path:"/",element:e.jsx(qr,{})}),e.jsx(_,{path:"/admin/login",element:e.jsx(ls,{})}),e.jsx(_,{path:"/admin/*",element:e.jsx(Br,{})}),e.jsx(_,{path:"*",element:e.jsx(we,{to:"/",replace:!0})})]})})})})}),Br=()=>{const{isAuthenticated:t}=Ie();return t?e.jsx(is,{}):e.jsx(we,{to:"/admin/login",replace:!0})},$e="1.3.0",Ge="app_version",_r=()=>{if(window.location.search.includes("t="))return console.log("页面已通过时间戳参数刷新，不再继续刷新"),localStorage.setItem(Ge,$e),!0;const t=localStorage.getItem(Ge);if(t!==$e){console.log(`版本不匹配: 当前=${$e}, 保存=${t}`);try{localStorage.removeItem("announcementData"),localStorage.removeItem("hasShownAnnouncementModal"),localStorage.setItem(Ge,$e),"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(s=>{for(let r of s)r.unregister()});const a=window.location.href.split("?")[0]+"?t="+new Date().getTime()+"&forcereload=true";window.location.href=a}catch(a){console.error("刷新出错:",a)}return!1}return!0};function Jr(){return _r()}Jr()&&Ye.createRoot(document.getElementById("root")).render(e.jsx(qe.StrictMode,{children:e.jsx(fa,{basename:"/gcxfz/",children:e.jsx(zr,{})})}));
